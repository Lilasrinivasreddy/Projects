select rule_MTN_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count" FROM ( SELECT CASE WHEN MTN IS NOT NULL THEN 'VALID' ELSE 'INVALID' END AS rule_MTN_DLA_SUM_FACT_V_Completeness FROM NTL_PRD_ALLVM.DLA_FACT_V WHERE ACTIVITY_DATE=CURRENT_DATE-1) AS subquery GROUP BY rule_MTN_DLA_SUM_FACT_V_Completeness

SRC_TBL	SRC_COL	DQ_PILLAR	MEAS_NAME	MEAS_RULE_DESC
DLA_SUM_FACT_V	PORT_CARRIER_CD	Completeness	rule_PORT_CARRIER_CD_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	VOLUNTARY_DISCONNECTS	Completeness	rule_VOLUNTARY_DISCONNECTS_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	MTN	Completeness	rule_MTN_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	SOR_ID	Completeness	rule_SOR_ID_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	CUST_ID	Completeness	rule_CUST_ID_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	CUST_LINE_SEQ_ID	Completeness	rule_CUST_LINE_SEQ_ID_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	ACTIVITY_CD	Completeness	rule_ACTIVITY_CD_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	MTN	Completeness	rule_MTN_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	ACCT_NUM	Completeness	rule_ACCT_NUM_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	CUST_TYPE_CD	Completeness	rule_CUST_TYPE_CD_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	GROSS_ADDS	Completeness	rule_GROSS_ADDS_DLA_SUM_FACT_V_Completeness	Null Check
DLA_SUM_FACT_V	GROSS_ADDS	Completeness	rule_GROSS_ADDS_DLA_SUM_FACT_V_Completeness	Null Check


Fact table name	Column	Pseudo Rule	Completed
NTL_PRD_ALLVM.DLA_SUM_FACT_V	PORT_CARRIER_CD 	When change_reas_cd = 91 , then PORT_CARRIER_CD  should not be null 	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	VOLUNTARY_DISCONNECTS 	when ACTIVITY_CD='DE' and CHANGE_REAS_CD=91, then VOLUNTARY_DISCONNECTS should be 1	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	MTN	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	SOR_ID	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	CUST_ID	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	CUST_LINE_SEQ_ID	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	ACTIVITY_CD	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	MTN	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	ACCT_NUM	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	CUST_TYPE_CD	Null check	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	GROSS_ADDS	" WHEN dla.activity_cd = 'AC',THEN 1
"	
NTL_PRD_ALLVM.DLA_SUM_FACT_V	GROSS_ADDS	WHEN dla.activity_cd IN ( 'D3','D6' ) THEN -1	
