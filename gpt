March 20, 2025 - 21:56:48
Django version 5.1.1, using settings 'dqaas_api.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CTRL-BREAK.

2025-03-20 21:57:01,332 - INFO - 📂 Received FILES: <MultiValueDict: {'file': [<InMemoryUploadedFile: file.txt (text/plain)>]}>
2025-03-20 21:57:01,333 - INFO - 🔍 Fixing SQL Query Formatting:
insert into vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12)

2025-03-20 21:57:01,334 - INFO - ✅ Fixed Query:
insert into "vz-it-np-izcv-dev-idmcdo-0".dga_dq_tbls.dqaas_profile_rpt
(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12)

2025-03-20 21:57:01,335 - INFO - 📌 Executing Fixed Query:
insert into "vz-it-np-izcv-dev-idmcdo-0".dga_dq_tbls.dqaas_profile_rpt
(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12)
2025-03-20 21:57:01,336 - INFO - 🔄 Connecting to Teradata...
2025-03-20 21:57:03,355 - INFO - ✅ Teradata connection successful!
2025-03-20 21:57:03,356 - ERROR - ❌ Query execution failed: insert into "vz-it-np-izcv-dev-idmcdo-0".dga_dq_tbls.dqaas_profile_rpt
(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12)
Error: list index out of range
Internal Server Error: /mle/ExecuteHistorySQL/
2025-03-20 21:57:03,358 - ERROR - Internal Server Error: /mle/ExecuteHistorySQL/
[20/Mar/2025 21:57:03] "POST /mle/ExecuteHistorySQL/ HTTP/1.1" 500 59



{"status": "failure", "message": "list index out of range"}
