import re

# List of expected column names
expected_columns = [
    "CHURN_POSTPAID_BASE_TOTAL", "CHURN_POSTPAID_BASE_PHONE", "CHURN_POSTPAID_BASE_SMARTPHONE",
    "CHURN_POSTPAID_BASE_TABLET", "CHURN_POSTPAID_BASE_HUM", "CHURN_POSTPAID_BASE_OTHER",
    "CHURN_PREPAID_BASE_TOTAL", "CHURN_PREPAID_BASE_SMARTPHONE", "CHURN_POSTPAID_FWA_BASE_TOTAL",
    "VOLUNTARY_POSTPAID_DISCOS", "INVOLUNTARY_POSTPAID_DISCOS", "VOL_POSTPAID_PHONE_DISCOS",
    "VOL_POSTPAID_TABLET_DISCOS", "VOL_POSTPAID_OTHER_DISCOS", "INVOL_POSTPAID_PHONE_DISCOS",
    "INVOL_POSTPAID_TABLET_DISCOS", "INVOL_POSTPAID_OTHER_DISCOS", "GROSS_ADDS_TOTAL",
    "GROSS_ADDS_PHONE", "GROSS_ADDS_SMARTPHONE", "GROSS_ADDS_TABLET", "GROSS_ADDS_HUM",
    "GROSS_ADDS_APPLE_SMARTWATCH", "GROSS_ADDS_OTHER", "OS_MIX_APPLE_SMARTPHONE_GROSS_ADDS",
    "OS_MIX_ANDROID_SMARTPHONE_GROSS_ADDS", "OS_MIX_SAMSUNG_SMARTPHONE_GROSS_ADDS",
    "OS_MIX_GOOGLE_SMARTPHONE_GROSS_ADDS", "OS_MIX_OTHER_ANDROID_SMARTPHONE_GROSS_ADDS",
    "OS_MIX_TOTAL_SMARTPHONE_GROSS_ADDS", "OS_MIX_TOTAL_PHONE_GROSS_ADDS",
    "OS_MIX_TOTAL_DEVICE_GROSS_ADDS", "OS_MIX_MOTO_SMARTPHONE_GROSS_ADDS",
    "GROSS_ADDS_TOTAL_FWA", "B2B_M2M_GROSS_ADDS_TOTAL_FWA", "GROSS_ADDS_OTHER_WEARABLES",
    "GROSS_ADDS_PHONE_AAL", "2nd LINE ACTIVITY GROSS ADDS", "GROSS_ADDS_PHONE_NEW",
    "2nd LINE ACTIVITY NET ADDS", "NET_ADDS_TOTAL", "NET_ADDS_PHONE", "NET_ADDS_SMARTPHONE",
    "NET_ADDS_TABLET", "NET_ADDS_HUM", "NET_ADDS_APPLE_SMARTWATCH", "NET_ADDS_OTHER",
    "NET_ADDS_TOTAL_FWA", "B2B_M2M_NET_ADDS_TOTAL_FWA", "NET_ADDS_OTHER_WEARABLES",
    "NET_DEACTS_TOTAL", "NET_DEACTS_PHONE", "NET_DEACTS_SMARTPHONE", "NET_DEACTS_TABLET",
    "NET_DEACTS_HUM", "NET_DEACTS_APPLE_SMARTWATCH", "NET_DEACTS_OTHER",
    "NET_DEACTS_TOTAL_FWA", "B2B_M2M_NET_DEACTS_TOTAL_FWA", "NET_DEACTS_OTHER_WEARABLES",
    "ARD_NUM", "ARD_DEN"
]

# Read the provided SQL query
sql_query = """
PASTE_YOUR_QUERY_HERE
"""

# Extract column names from the SQL query
column_pattern = re.compile(r"\b([A-Z0-9_]+)\b")
extracted_columns = set(column_pattern.findall(sql_query))

# Find matches and missing columns
matched_columns = set(expected_columns) & extracted_columns
missing_columns = set(expected_columns) - extracted_columns
extra_columns = extracted_columns - set(expected_columns)

# Print results
print("Matched Columns:", matched_columns)
print("\nMissing Columns:", missing_columns)
print("\nExtra Columns (Present in Query but Not in Expected List):", extra_columns)
