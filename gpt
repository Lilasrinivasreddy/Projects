obs_poc_cnt = process_df['obs_poc'].isna().sum()
                program_name_validation_cnt = process_df['program_name'].isna().sum()
                application_name_validation_cnt = process_df['application_name'].isna().sum()+process_df.loc[process_df['application_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                process_name_validation_cnt = process_df['process_name'].isna().sum() +process_df.loc[process_df['process_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                subprocess_name_validation_cnt = process_df['subprocess_name'].isna().sum() +process_df.loc[process_df['subprocess_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                process_df["frequency"] = process_df["frequency"].str.lower()
                frequency_validation_cnt = process_df['frequency'].isna().sum() + (total_process_count - process_df['frequency'].str.strip().str.lower().isin(frequency_list).sum())
                process_df['is_critical']= process_df['is_critical'].replace('',"N")
                is_critical_validation_cnt = total_process_count-process_df['is_critical'].fillna('n').str.lower().isin(flags).sum()
                platform_name_validtion_cnt = total_process_count - process_df['platform_name'].fillna('na').str.lower().isin(platform_list).sum()
                env_name_validtion_cnt = total_process_count - process_df['env_name'].fillna('na').str.lower().isin(env_list).sum()
                process_poc_validation_cnt =  total_process_count -  process_df.loc[process_df['process_poc'].fillna('na').str.contains(r'[^@]+@[^@]+\.[^@]+',case=False), :].shape[0]
                scheduler_name_validation_cnt =  total_process_count - process_df['scheduler_name'].fillna('na').str.lower().isin(scheduler_list).sum()
                step_id_validation_cnt =  total_process_count - process_df.loc[process_df['step_id'].fillna('1').str.contains(r'[0-9]',case=False), :].shape[0]
                #process_df['logs_enabled' ]= process_df['logs_enabled'].replace('',"N")
                logs_enabled_validation_cnt =  total_process_count - process_df['logs_enabled'].str.lower().isin(flags).sum()
                process_df['is_mandatory'] = process_df['is_mandatory'].replace('',"N")
                is_mandatory_validation_cnt =  total_process_count - process_df['is_mandatory'].fillna('n').str.lower().isin(flags).sum()
                businessunit_validation_cnt =  total_process_count - process_df['businessunit'].fillna('n').str.lower().isin(businessunit_list).sum()
                vsad_validation_cnt = process_df['vsad'].isna().sum()
                #process_df["timezone"] = process_df["timezone"].fillna("UTC")
                process_df["timezone"] = process_df["timezone"].replace('',"UTC")
                process_df["timezone"] = process_df["timezone"].str.upper()
                timezone_validation_cnt = total_process_count - process_df['timezone'].isin(time_zone_list).sum()
                #process_df_source_filtered = process_df[process_df['source'].notna()]
                process_df_source_filtered = process_df[process_df['source'].str.len() != 0]
                source_type_validation_cnt = process_df_source_filtered.shape[0] - process_df_source_filtered['source_type'].str.lower().isin(source_type_list).sum()
                #process_df_target_filtered = process_df[process_df['target'].notna()]
                process_df_target_filtered = process_df[process_df['target'].str.len() != 0]
                target_type_validation_cnt = process_df_target_filtered.shape[0] - process_df_target_filtered['target_type'].str.lower().isin(target_type_list).sum()
                process_df["logs_trace_id_enabled"] = process_df["logs_trace_id_enabled"].fillna('N')
                logs_trace_id_enabled_validation_cnt =  total_process_count - process_df['logs_trace_id_enabled'].fillna('n').str.lower().isin(flags).sum()
                is_active_validation_cnt =  total_process_count - process_df['is_active'].fillna('n').str.lower().isin(flags).sum()
                process_df_is_active_filtered = process_df[process_df['is_active'].isin(['n','N'])]
                reason_is_active_change_validation_cnt = process_df_is_active_filtered.shape[0] - process_df_is_active_filtered[process_df_is_active_filtered['reason_is_active_change']!='nan'].shape[0]
                process_df['run_date_buffer_interval'] = process_df['run_date_buffer_interval'].replace('',"0")
                run_date_buffer_interval_validation_cnt =  total_process_count -process_df.loc[process_df['run_date_buffer_interval'].fillna('0').str.contains(r'[0-9]',case=False), :].shape[0]              
                process_df['collect_volume']=process_df['collect_volume'].replace('',"false")
                collect_volume_validation_cnt =  total_process_count - process_df['collect_volume'].fillna('false').str.lower().isin(bool_flag).sum()
                process_df_volume_query_filtered = process_df[process_df['collect_volume'].isin(['true','TRUE','True'])] 
                volume_query_validation_cnt = process_df_volume_query_filtered.shape[0] - process_df_volume_query_filtered.loc[~process_df_volume_query_filtered['volume_query'].isna(), 'volume_query'].shape[0]
                #process_df['duration_threshold_low_value'] = process_df['duration_threshold_low_value'].fillna('20')
                #process_df['duration_threshold_high_value'] = process_df['duration_threshold_high_value'].fillna('20')
                process_df['duration_threshold_low_value'] = process_df['duration_threshold_low_value'].replace('',"20")
                process_df['duration_threshold_high_value'] = process_df['duration_threshold_high_value'].replace('',"20")
                duration_threshold_low_value_validation_cnt =  total_process_count - process_df.loc[process_df['duration_threshold_low_value'].fillna('20').str.contains(r'[0-9]',case=False), :].shape[0]
                duration_threshold_high_value_validation_cnt =  total_process_count - process_df.loc[process_df['duration_threshold_high_value'].fillna('20').str.contains(r'[0-9]',case=False), :].shape[0]
                
                process_df['additional_info'] = process_df['additional_info'].replace(['NaN', 'nan', ''], np.nan)
                process_df_additional_info_filtered = process_df.dropna(subset = ['additional_info'])


obs_poc_cnt = process_df['obs_poc'].isna().sum()
                program_name_validation_cnt = process_df['program_name'].isna().sum()
                application_name_validation_cnt = process_df['application_name'].isna().sum()+process_df.loc[process_df['application_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                process_name_validation_cnt = process_df['process_name'].isna().sum() +process_df.loc[process_df['process_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                subprocess_name_validation_cnt = process_df['subprocess_name'].isna().sum() +process_df.loc[process_df['subprocess_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                process_df["frequency"] = process_df["frequency"].str.lower()
                frequency_validation_cnt = process_df['frequency'].isna().sum() + (total_process_count - process_df['frequency'].str.strip().str.lower().isin(frequency_list).sum())
                process_df['is_critical']= process_df['is_critical'].replace('',"N")
                is_critical_validation_cnt = total_process_count-process_df['is_critical'].fillna('n').str.lower().isin(flags).sum()
                platform_name_validtion_cnt = total_process_count - process_df['platform_name'].fillna('na').str.lower().isin(platform_list).sum()
                env_name_validtion_cnt = total_process_count - process_df['env_name'].fillna('na').str.lower().isin(env_list).sum()
                process_poc_validation_cnt =  total_process_count -  process_df.loc[process_df['process_poc'].fillna('na').str.contains(r'[^@]+@[^@]+\.[^@]+',case=False), :].shape[0]
                scheduler_name_validation_cnt =  total_process_count - process_df['scheduler_name'].fillna('na').str.lower().isin(scheduler_list).sum()
                step_id_validation_cnt =  total_process_count - process_df.loc[process_df['step_id'].fillna('1').str.contains(r'[0-9]',case=False), :].shape[0]
                #process_df['logs_enabled' ]= process_df['logs_enabled'].replace('',"N")
                logs_enabled_validation_cnt =  total_process_count - process_df['logs_enabled'].str.lower().isin(flags).sum()
                process_df['is_mandatory'] = process_df['is_mandatory'].replace('',"N")
                is_mandatory_validation_cnt =  total_process_count - process_df['is_mandatory'].fillna('n').str.lower().isin(flags).sum()
                businessunit_validation_cnt =  total_process_count - process_df['businessunit'].fillna('n').str.lower().isin(businessunit_list).sum()
                vsad_validation_cnt = process_df['vsad'].isna().sum()
                #process_df["timezone"] = process_df["timezone"].fillna("UTC")
                process_df["timezone"] = process_df["timezone"].replace('',"UTC")
                process_df["timezone"] = process_df["timezone"].str.upper()
                timezone_validation_cnt = total_process_count - process_df['timezone'].isin(time_zone_list).sum()
                #process_df_source_filtered = process_df[process_df['source'].notna()]
                process_df_source_filtered = process_df[process_df['source'].str.len() != 0]
                source_type_validation_cnt = process_df_source_filtered.shape[0] - process_df_source_filtered['source_type'].str.lower().isin(source_type_list).sum()
                #process_df_target_filtered = process_df[process_df['target'].notna()]
                process_df_target_filtered = process_df[process_df['target'].str.len() != 0]
                target_type_validation_cnt = process_df_target_filtered.shape[0] - process_df_target_filtered['target_type'].str.lower().isin(target_type_list).sum()
                process_df["logs_trace_id_enabled"] = process_df["logs_trace_id_enabled"].fillna('N')
                logs_trace_id_enabled_validation_cnt =  total_process_count - process_df['logs_trace_id_enabled'].fillna('n').str.lower().isin(flags).sum()
                is_active_validation_cnt =  total_process_count - process_df['is_active'].fillna('n').str.lower().isin(flags).sum()
                process_df_is_active_filtered = process_df[process_df['is_active'].isin(['n','N'])]
                reason_is_active_change_validation_cnt = process_df_is_active_filtered.shape[0] - process_df_is_active_filtered[process_df_is_active_filtered['reason_is_active_change']!='nan'].shape[0]
                process_df['run_date_buffer_interval'] = process_df['run_date_buffer_interval'].replace('',"0")
                run_date_buffer_interval_validation_cnt =  total_process_count -process_df.loc[process_df['run_date_buffer_interval'].fillna('0').str.contains(r'[0-9]',case=False), :].shape[0]              
                process_df['collect_volume']=process_df['collect_volume'].replace('',"false")
                collect_volume_validation_cnt =  total_process_count - process_df['collect_volume'].fillna('false').str.lower().isin(bool_flag).sum()
                process_df_volume_query_filtered = process_df[process_df['collect_volume'].isin(['true','TRUE','True'])] 
                volume_query_validation_cnt = process_df_volume_query_filtered.shape[0] - process_df_volume_query_filtered.loc[~process_df_volume_query_filtered['volume_query'].isna(), 'volume_query'].shape[0]
                #process_df['duration_threshold_low_value'] = process_df['duration_threshold_low_value'].fillna('20')
                #process_df['duration_threshold_high_value'] = process_df['duration_threshold_high_value'].fillna('20')
                process_df['duration_threshold_low_value'] = process_df['duration_threshold_low_value'].replace('',"20")
                process_df['duration_threshold_high_value'] = process_df['duration_threshold_high_value'].replace('',"20")
                duration_threshold_low_value_validation_cnt =  total_process_count - process_df.loc[process_df['duration_threshold_low_value'].fillna('20').str.contains(r'[0-9]',case=False), :].shape[0]
                duration_threshold_high_value_validation_cnt =  total_process_count - process_df.loc[process_df['duration_threshold_high_value'].fillna('20').str.contains(r'[0-9]',case=False), :].shape[0]
                
                process_df['additional_info'] = process_df['additional_info'].replace(['NaN', 'nan', ''], np.nan)
                process_df_additional_info_filtered = process_df.dropna(subset = ['additional_info'])
process_alert_notification_df.dropna(axis=0, how="all", inplace=True)
                all_columns = list(process_alert_notification_df) # Creates list of all column headers
                process_alert_notification_df[all_columns] = process_alert_notification_df[all_columns].astype(str)
                total_alert_notification_df_count = process_alert_notification_df.shape[0]
                application_name_validation_count_a= process_alert_notification_df['application_name'].isna().sum()+process_alert_notification_df.loc[process_alert_notification_df['application_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                program_name_validation_count_a	 = process_alert_notification_df['program_name'].isna().sum()
                process_name_validation_count_a = process_alert_notification_df['process_name'].isna().sum() +process_alert_notification_df.loc[process_alert_notification_df['process_name'].str.strip().str.contains(r'\s',case=False), :].shape[0]
                platform_name_validation_count_a = total_alert_notification_df_count - process_alert_notification_df['platform_name'].fillna('na').str.lower().isin(platform_list).sum()	
                env_name_validation_count_a = total_alert_notification_df_count - process_alert_notification_df['env_name'].fillna('na').str.lower().isin(env_list).sum()
                duplicate_rows = process_alert_notification_df.duplicated(subset=['application_name', 'program_name','process_name','env_name'])
                process_alert_notification_duplicate_count_a = duplicate_rows.sum()
                alert_failure_validation_count_a =  total_alert_notification_df_count - process_alert_notification_df['alert_failure'].fillna('N').str.lower().isin(flags).sum()
                process_alert_notification_df["process_failed_alert_priority"] = process_alert_notification_df["process_failed_alert_priority"].fillna('P3').replace('',"P3")
                process_failed_alert_priority_validation_count_a = total_alert_notification_df_count  - process_alert_notification_df["process_failed_alert_priority"].isin(priority_list).sum()
                alert_sla_misses_validation_count_a =  total_alert_notification_df_count - process_alert_notification_df['alert_sla_misses'].fillna('N').str.lower().isin(flags).sum()
                process_alert_notification_df["process_sla_miss_alert_priority"] = process_alert_notification_df["process_sla_miss_alert_priority"].fillna("P3").replace('',"P3")
                process_sla_miss_alert_priority_validation_count_a =  total_alert_notification_df_count  - process_alert_notification_df["process_sla_miss_alert_priority"].isin(priority_list).sum()
                alert_pending_validation_count_a =  total_alert_notification_df_count - process_alert_notification_df['alert_pending'].fillna('N').str.lower().isin(flags).sum() 
                process_alert_notification_df["process_pending_alert_priority"] = process_alert_notification_df["process_pending_alert_priority"].fillna("P3").replace('',"P3")
                process_pending_alert_priority_validation_count_a = total_alert_notification_df_count  - process_alert_notification_df["process_pending_alert_priority"].isin(priority_list).sum()
             

#-----------------------PROCESS META VALIDATION SCRIPT-----------------------
if not process_meta.empty:
    # Drop rows with all empty values
    process_meta.dropna(axis=0, how="all", inplace=True)
    total_process_count = process_meta.shape[0]

    # Replace empty strings with null values
    process_meta = process_meta.infer_objects(copy=False).replace(r'^\s*$', np.nan, regex=True)

    # Remove leading/trailing whitespaces
    process_meta = process_meta.applymap(lambda x: x.strip() if isinstance(x, str) else x)

    # Update variables based on the environment
    if "dev" in env:
        process_meta.replace(dict(zip(variable_list, dev_list)), inplace=True, regex=True)
    elif "test" in env:
        process_meta.replace(variable_list, test_list, inplace=True, regex=True)
    elif "ple" in env:
        process_meta.replace(variable_list, ple_list, inplace=True, regex=True)
    else:
        process_meta.replace(variable_list, prod_list, inplace=True, regex=True)

    process_meta = process_meta.astype("string")

    # Update Data Types for Integer Columns
    for col in process_integer_column:
        process_meta[col] = process_meta[col].replace('', np.nan).fillna('0').astype(int)

    # Update Data Types for Boolean Columns
    for col in process_boolean_column:
        process_meta[col] = process_meta[col].replace('', np.nan).map({'Y': True, 'N': False}).fillna(False)

    # ----------------------------- VALIDATIONS -----------------------------------

    # OBS POC Validation
    obs_poc_cnt = process_meta['obs_poc'].isna().sum()

    # Program Name Validation
    program_name_validation_cnt = process_meta['program_name'].isna().sum()

    # Application Name Validation
    application_name_validation_cnt = process_meta['application_name'].isna().sum() + process_meta.loc[
        process_meta['application_name'].str.strip().str.contains(r'\s', case=False), :].shape[0]

    # Process Name Validation
    process_name_validation_cnt = process_meta['process_name'].isna().sum() + process_meta.loc[
        process_meta['process_name'].str.strip().str.contains(r'\s', case=False), :].shape[0]

    # Subprocess Name Validation
    subprocess_name_validation_cnt = process_meta['subprocess_name'].isna().sum() + process_meta.loc[
        process_meta['subprocess_name'].str.strip().str.contains(r'\s', case=False), :].shape[0]

    # Frequency Validation
    process_meta["frequency"] = process_meta["frequency"].str.lower()
    frequency_validation_cnt = process_meta['frequency'].isna().sum() + (
        total_process_count - process_meta['frequency'].str.strip().str.lower().isin(frequency_list).sum())

    # Is Critical Validation
    process_meta['is_critical'] = process_meta['is_critical'].replace('', "N")
    is_critical_validation_cnt = total_process_count - process_meta['is_critical'].fillna('n').str.lower().isin(flags).sum()

    # Platform Name Validation
    platform_name_validation_cnt = total_process_count - process_meta['platform_name'].fillna('na').str.lower().isin(platform_list).sum()

    # Environment Name Validation
    env_name_validation_cnt = total_process_count - process_meta['env_name'].fillna('na').str.lower().isin(env_list).sum()

    # Process POC Validation (Email Format)
    process_poc_validation_cnt = total_process_count - process_meta.loc[
        process_meta['process_poc'].fillna('na').str.contains(r'[^@]+@[^@]+\.[^@]+', case=False), :].shape[0]

    # Scheduler Name Validation
    scheduler_name_validation_cnt = total_process_count - process_meta['scheduler_name'].fillna('na').str.lower().isin(scheduler_list).sum()

    # Logs Enabled Validation
    logs_enabled_validation_cnt = total_process_count - process_meta['logs_enabled'].str.lower().isin(flags).sum()

    # Mandatory Validation
    process_meta['is_mandatory'] = process_meta['is_mandatory'].replace('', "N")
    is_mandatory_validation_cnt = total_process_count - process_meta['is_mandatory'].fillna('n').str.lower().isin(flags).sum()

    # Business Unit Validation
    businessunit_validation_cnt = total_process_count - process_meta['businessunit'].fillna('n').str.lower().isin(businessunit_list).sum()

    # VSAD Validation
    vsad_validation_cnt = process_meta['vsad'].isna().sum()

    # Timezone Validation
    process_meta["timezone"] = process_meta["timezone"].replace('', "UTC").str.upper()
    timezone_validation_cnt = total_process_count - process_meta['timezone'].isin(time_zone_list).sum()

    # Source and Target Validation
    process_meta_source_filtered = process_meta[process_meta['source'].str.len() != 0]
    source_type_validation_cnt = process_meta_source_filtered.shape[0] - process_meta_source_filtered['source_type'].str.lower().isin(source_type_list).sum()
    process_meta_target_filtered = process_meta[process_meta['target'].str.len() != 0]
    target_type_validation_cnt = process_meta_target_filtered.shape[0] - process_meta_target_filtered['target_type'].str.lower().isin(target_type_list).sum()

    # Run Date Buffer Validation
    process_meta['run_date_buffer_interval'] = process_meta['run_date_buffer_interval'].replace('', "0")
    run_date_buffer_interval_validation_cnt = total_process_count - process_meta.loc[
        process_meta['run_date_buffer_interval'].fillna('0').str.contains(r'[0-9]', case=False), :].shape[0]

    # Collect Volume Validation
    process_meta['collect_volume'] = process_meta['collect_volume'].replace('', "false")
    collect_volume_validation_cnt = total_process_count - process_meta['collect_volume'].fillna('false').str.lower().isin(bool_flag).sum()

    # Duration Threshold Validation
    process_meta['duration_threshold_low_value'] = process_meta['duration_threshold_low_value'].replace('', "20")
    process_meta['duration_threshold_high_value'] = process_meta['duration_threshold_high_value'].replace('', "20")
    duration_threshold_low_value_validation_cnt = total_process_count - process_meta.loc[
        process_meta['duration_threshold_low_value'].fillna('20').str.contains(r'[0-9]', case=False), :].shape[0]
    duration_threshold_high_value_validation_cnt = total_process_count - process_meta.loc[
        process_meta['duration_threshold_high_value'].fillna('20').str.contains(r'[0-9]', case=False), :].shape[0]

    # ----------------------------- RAISE ERRORS -----------------------------------
    if obs_poc_cnt > 0:
        raise ValueError(f"Missing OBS POC values: {obs_poc_cnt}")
    if program_name_validation_cnt > 0:
        raise ValueError(f"Missing Program Names: {program_name_validation_cnt}")
    if application_name_validation_cnt > 0:
        raise ValueError(f"Invalid Application Names: {application_name_validation_cnt}")
    if process_name_validation_cnt > 0:
        raise ValueError(f"Invalid Process Names: {process_name_validation_cnt}")
    if subprocess_name_validation_cnt > 0:
        raise ValueError(f"Invalid Subprocess Names: {subprocess_name_validation_cnt}")
    if frequency_validation_cnt > 0:
        raise ValueError(f"Invalid Frequency values: {frequency_validation_cnt}")
    if is_critical_validation_cnt > 0:
        raise ValueError(f"Invalid Is Critical values: {is_critical_validation_cnt}")
    if platform_name_validation_cnt > 0:
        raise ValueError(f"Invalid Platform Names: {platform_name_validation_cnt}")
    if env_name_validation_cnt > 0:
        raise ValueError(f"Invalid Environment Names: {env_name_validation_cnt}")
    if process_poc_validation_cnt > 0:
        raise ValueError(f"Invalid Process POC Emails: {process_poc_validation_cnt}")
    if scheduler_name_validation_cnt > 0:
        raise ValueError(f"Invalid Scheduler Names: {scheduler_name_validation_cnt}")
    if logs_enabled_validation_cnt > 0:
        raise ValueError(f"Invalid Logs Enabled values: {logs_enabled_validation_cnt}")
    if is_mandatory_validation_cnt > 0:
        raise ValueError(f"Invalid Is Mandatory values: {is_mandatory_validation_cnt}")
    if businessunit_validation_cnt > 0:
        raise ValueError(f"Invalid Business Unit values: {businessunit_validation_cnt}")
    if vsad_validation_cnt > 0:
        raise ValueError(f"Missing VSAD values: {vsad_validation_cnt}")
    if timezone_validation_cnt > 0:
        raise ValueError(f"Invalid Timezone values: {timezone_validation_cnt}")
    if source_type_validation_cnt > 0:
        raise ValueError(f"Invalid Source Types: {source_type_validation_cnt}")
    if target_type_validation_cnt > 0:
        raise ValueError(f"Invalid Target Types: {target_type_validation_cnt}")
    if run_date_buffer_interval_validation_cnt > 0:
        raise ValueError(f"Invalid Run Date Buffer Interval values: {run_date_buffer_interval_validation_cnt}")
    if collect_volume_validation_cnt > 0:
        raise ValueError(f"Invalid Collect Volume values: {collect_volume_validation_cnt}")
    if duration_threshold_low_value_validation_cnt > 0:
        raise ValueError(f"Invalid Duration Threshold Low values: {duration_threshold_low_value_validation_cnt}")
