if not df_report_result.empty:
    for col in df_report_result.select_dtypes(include=['Int64']).columns:
        self.logger.info(f"Converting column {col} from Int64Dtype to int64")
        df_report_result[col] = df_report_result[col].astype(pd.Int64Dtype()).astype('int64')



if not df_tbl_hist_rec.empty:
    for col in df_tbl_hist_rec.select_dtypes(include=['Int64']).columns:
        self.logger.info(f"Converting column {col} in df_tbl_hist_rec from Int64Dtype to int64")
        df_tbl_hist_rec[col] = df_tbl_hist_rec[col].astype(pd.Int64Dtype()).astype('int64')

if not df_tbl_latest_rec.empty:
    for col in df_tbl_latest_rec.select_dtypes(include=['Int64']).columns:
        self.logger.info(f"Converting column {col} in df_tbl_latest_rec from Int64Dtype to int64")
        df_tbl_latest_rec[col] = df_tbl_latest_rec[col].astype(pd.Int64Dtype()).astype('int64')


if not df_latest.empty:
    df_latest["prfl_run_ts"] = datetime.now().strftime(config.DTM_FMT)
else:
    self.logger.warning("df_latest is empty, skipping timestamp assignment.")




