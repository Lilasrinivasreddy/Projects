select COALESCE(SUM(valid), 0) AS passed, COALESCE(SUM(invalid), 0) AS failed from (SELECT
    CASE WHEN rule_PL_epm_p20gmgn_market_Accuracy_1 = 'VALID' THEN 1 ElSE 0 END AS valid,
    CASE WHEN rule_PL_epm_p20gmgn_market_Accuracy_1 = 'INVALID' THEN 1 ELSE 0 END AS invalid
FROM (SELECT CASE WHEN UPPER(market) NOT LIKE '%NONE' AND model ='Wireline' THEN "INVALID" ELSE "VALID" END AS rule_PL_epm_p20gmgn_market_Accuracy_1 FROM `vz-it-pr-j0nv-oddo-0.od_published_epm.epm_p20gmgn_actuals_v` WHERE CONCAT(REPLACE(year,'FY','20'), CASE WHEN period = 'Jan' THEN '01' WHEN period = 'Feb' THEN '02' WHEN period = 'Mar' THEN '03' WHEN period = 'Apr' THEN '04' WHEN period = 'May' THEN '05' WHEN period = 'May' THEN '05' WHEN period = 'Jun' THEN '06' WHEN period = 'Jul' THEN '07' WHEN period = 'Aug' THEN '08' WHEN period = 'Sep' THEN '09' WHEN period = 'Oct' THEN '10' WHEN period = 'Nov' THEN '11' WHEN period = 'Dec' THEN '12' END) BETWEEN current_date -1 AND current_date -1 as temp valid_invalid_scenario
