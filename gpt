SELECT 
    cast(PYMNT_TRANS_DT AS date) AS profile_date, 
    'Executive Reports' AS feature_name, 
    COALESCE(dimension, 'Unknown') AS dimension,  -- Replace NULL in dimension with 'Unknown'
    count(*) AS "value", 
    current_timestamp AS insert_date, 
    dayofweek(cast(PYMNT_TRANS_DT AS date)) AS weekday
FROM 
    NTL_PRD_ALLVM.PAYMENT_WO_FIN_V
GROUP BY 
    cast(PYMNT_TRANS_DT AS date), 
    'Executive Reports', 
    dimension,  -- Ensure grouping by actual dimension
    dayofweek(cast(PYMNT_TRANS_DT AS date))  -- Group by weekday
ORDER BY 
    profile_date, weekday;  -- Ensure proper sorting for better visibility
