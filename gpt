2025-04-08 06:40:03 : DQ-PROCESS-Main - run_bq_sql - INFO : 
BQ Query: select T1.profile_id,T1.profile_type,T1.project_name,T1.database_name,T1.table_name,T1.email_type,T1.product_name,T1.data_sub_dmn,T1.active_flag,T1.data_src,T1.feature_name,T1.column_name,T1.rule_desc,T1.incr_date_col,T1.incr_date_cond,T1.unique_index_cols,T1.tag_name,T1.table_ind,T1.invalid_rec_sql,T1.history_load_sql,T1.critical_flag,T1.micro_seg_cols,T1.aggregated_col,T1.comparison_type,T1.business_term_desc,T1.profile_schedule_ts,T1.threshold_limit,T1.max_threshold_limit,T1.email_distro,T1.opsgenie_flag,T1.opsgenie_team,T1.opsgenie_api,T1.parsed_sql,T1.jira_assignee,T1.run_frequency,T1.data_lob,T1.rule_name,T1.dq_pillar,T1.rule_sql,T1.daily_flag,T1.invalid_records_flag,T1.auto_rerun_flag,T1.invalid_sql_required,T1.rerun_required,T1.vsad,T2.table_id, T2.server_name,T2.run_status,T2.data_availability_indicator,T2.run_dt
            from vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_meta T1  join
            vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_control_table T2 on  
            T1.database_name = T2.database_name AND T1.table_name = T2.table_name AND  T1.profile_id = T2.table_id
            WHERE  T2.data_availability_indicator = 'Y' and T1.active_flag = 'Y' AND T2.run_status in ('Ready','RR') AND T1.data_src = 'TD' AND cast(run_dt AS DATE) = date(current_timestamp(),'US/Eastern') AND server_name = 'tdclpizcva007.verizon.com' 
2025-04-08 06:40:03 : DQ-PROCESS-Main - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq/dqaas//keys/dq_oidc_token.json
2025-04-08 06:40:03 : DQ-PROCESS-Main - isTokenExpired - INFO : Token File Available
2025-04-08 06:40:03 : DQ-PROCESS-Main - isTokenExpired - INFO : Access Token is Valid
2025-04-08 06:40:03 : DQ-PROCESS-Main - bigquery_client - INFO : Setting environment variable...
2025-04-08 06:40:03 : DQ-PROCESS-Main - bigquery_client - INFO : Connected to vz-it-pr-izcv-idmcdo-0 project space
2025-04-08 06:40:03 : DQ-PROCESS-Main - run_bq_sql - INFO : 
BQ Query: select T1.profile_id,T1.profile_type,T1.project_name,T1.database_name,T1.table_name,T1.email_type,T1.product_name,T1.data_sub_dmn,T1.active_flag,T1.data_src,T1.feature_name,T1.column_name,T1.rule_desc,T1.incr_date_col,T1.incr_date_cond,T1.unique_index_cols,T1.tag_name,T1.table_ind,T1.invalid_rec_sql,T1.history_load_sql,T1.critical_flag,T1.micro_seg_cols,T1.aggregated_col,T1.comparison_type,T1.business_term_desc,T1.profile_schedule_ts,T1.threshold_limit,T1.max_threshold_limit,T1.email_distro,T1.opsgenie_flag,T1.opsgenie_team,T1.opsgenie_api,T1.parsed_sql,T1.jira_assignee,T1.run_frequency,T1.data_lob,T1.rule_name,T1.dq_pillar,T1.rule_sql,T1.daily_flag,T1.invalid_records_flag,T1.auto_rerun_flag,T1.invalid_sql_required,T1.rerun_required,T1.vsad,T2.table_id, T2.server_name,T2.run_status,T2.data_availability_indicator,T2.run_dt
            from vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_meta T1  join
            vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_control_table T2 on  
            T1.database_name = T2.database_name AND T1.table_name = T2.table_name AND  T1.profile_id = T2.table_id
            WHERE  T2.data_availability_indicator = 'Y' and T1.active_flag = 'Y' AND T2.run_status in ('Ready','RR') AND T1.data_src = 'GCP' AND cast(run_dt AS DATE) = date(current_timestamp(),'US/Eastern') AND server_name = 'tdclpizcva007.verizon.com' 
2025-04-08 06:40:03 : DQ-PROCESS-Main - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq/dqaas//keys/dq_oidc_token.json
2025-04-08 06:40:03 : DQ-PROCESS-Main - isTokenExpired - INFO : Token File Available
2025-04-08 06:40:03 : DQ-PROCESS-Main - isTokenExpired - INFO : Access Token is Valid
2025-04-08 06:40:03 : DQ-PROCESS-Main - bigquery_client - INFO : Setting environment variable...
2025-04-08 06:40:03 : DQ-PROCESS-Main - bigquery_client - INFO : Connected to vz-it-pr-izcv-idmcdo-0 project space
2025-04-08 06:40:06 : DQ-PROCESS-Main - read_metadata - INFO : read meta data query: select T1.profile_id,T1.profile_type,T1.project_name,T1.database_name,T1.table_name,T1.email_type,T1.product_name,T1.data_sub_dmn,T1.active_flag,T1.data_src,T1.feature_name,T1.column_name,T1.rule_desc,T1.incr_date_col,T1.incr_date_cond,T1.unique_index_cols,T1.tag_name,T1.table_ind,T1.invalid_rec_sql,T1.history_load_sql,T1.critical_flag,T1.micro_seg_cols,T1.aggregated_col,T1.comparison_type,T1.business_term_desc,T1.profile_schedule_ts,T1.threshold_limit,T1.max_threshold_limit,T1.email_distro,T1.opsgenie_flag,T1.opsgenie_team,T1.opsgenie_api,T1.parsed_sql,T1.jira_assignee,T1.run_frequency,T1.data_lob,T1.rule_name,T1.dq_pillar,T1.rule_sql,T1.daily_flag,T1.invalid_records_flag,T1.auto_rerun_flag,T1.invalid_sql_required,T1.rerun_required,T1.vsad,T2.table_id, T2.server_name,T2.run_status,T2.data_availability_indicator,T2.run_dt
            from vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_meta T1  join
            vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_control_table T2 on  
            T1.database_name = T2.database_name AND T1.table_name = T2.table_name AND  T1.profile_id = T2.table_id
            WHERE  T2.data_availability_indicator = 'Y' and T1.active_flag = 'Y' AND T2.run_status in ('Ready','RR') AND T1.data_src = 'GCP' AND cast(run_dt AS DATE) = date(current_timestamp(),'US/Eastern') AND server_name = 'tdclpizcva007.verizon.com' 
2025-04-08 06:40:06 : DQ-PROCESS-Main - read_metadata - INFO : Count Result: 0
2025-04-08 06:40:06 : DQ-PROCESS-Main - process_main - INFO : metadata_df: Empty DataFrame
Columns: [profile_id, profile_type, project_name, database_name, table_name, email_type, product_name, data_sub_dmn, active_flag, data_src, feature_name, column_name, rule_desc, incr_date_col, incr_date_cond, unique_index_cols, tag_name, table_ind, invalid_rec_sql, history_load_sql, critical_flag, micro_seg_cols, aggregated_col, comparison_type, business_term_desc, profile_schedule_ts, threshold_limit, max_threshold_limit, email_distro, opsgenie_flag, opsgenie_team, opsgenie_api, parsed_sql, jira_assignee, run_frequency, data_lob, rule_name, dq_pillar, rule_sql, daily_flag, invalid_records_flag, auto_rerun_flag, invalid_sql_required, rerun_required, vsad, table_id, server_name, run_status, data_availability_indicator, run_dt]
Index: []
2025-04-08 06:40:06 : DQ-PROCESS-Main - read_metadata - INFO : read meta data query: select T1.profile_id,T1.profile_type,T1.project_name,T1.database_name,T1.table_name,T1.email_type,T1.product_name,T1.data_sub_dmn,T1.active_flag,T1.data_src,T1.feature_name,T1.column_name,T1.rule_desc,T1.incr_date_col,T1.incr_date_cond,T1.unique_index_cols,T1.tag_name,T1.table_ind,T1.invalid_rec_sql,T1.history_load_sql,T1.critical_flag,T1.micro_seg_cols,T1.aggregated_col,T1.comparison_type,T1.business_term_desc,T1.profile_schedule_ts,T1.threshold_limit,T1.max_threshold_limit,T1.email_distro,T1.opsgenie_flag,T1.opsgenie_team,T1.opsgenie_api,T1.parsed_sql,T1.jira_assignee,T1.run_frequency,T1.data_lob,T1.rule_name,T1.dq_pillar,T1.rule_sql,T1.daily_flag,T1.invalid_records_flag,T1.auto_rerun_flag,T1.invalid_sql_required,T1.rerun_required,T1.vsad,T2.table_id, T2.server_name,T2.run_status,T2.data_availability_indicator,T2.run_dt
            from vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_meta T1  join
            vz-it-pr-izcv-idmcdo-0.dga_dq_tbls.dqaas_control_table T2 on  
            T1.database_name = T2.database_name AND T1.table_name = T2.table_name AND  T1.profile_id = T2.table_id
            WHERE  T2.data_availability_indicator = 'Y' and T1.active_flag = 'Y' AND T2.run_status in ('Ready','RR') AND T1.data_src = 'TD' AND cast(run_dt AS DATE) = date(current_timestamp(),'US/Eastern') AND server_name = 'tdclpizcva007.verizon.com' 
2025-04-08 06:40:06 : DQ-PROCESS-Main - read_metadata - INFO : Count Result: 0
2025-04-08 06:40:06 : DQ-PROCESS-Main - process_main - INFO : metadata_df: Empty DataFrame
Columns: [profile_id, profile_type, project_name, database_name, table_name, email_type, product_name, data_sub_dmn, active_flag, data_src, feature_name, column_name, rule_desc, incr_date_col, incr_date_cond, unique_index_cols, tag_name, table_ind, invalid_rec_sql, history_load_sql, critical_flag, micro_seg_cols, aggregated_col, comparison_type, business_term_desc, profile_schedule_ts, threshold_limit, max_threshold_limit, email_distro, opsgenie_flag, opsgenie_team, opsgenie_api, parsed_sql, jira_assignee, run_frequency, data_lob, rule_name, dq_pillar, rule_sql, daily_flag, invalid_records_flag, auto_rerun_flag, invalid_sql_required, rerun_required, vsad, table_id, server_name, run_status, data_availability_indicator, run_dt]
Index: []
