select current_date as meas_dt,sum(submarket_pttrn) as meas_value,current_timestamp load_ts from (select case when safe_cast(submarket as STRING) is not null then 0 else 1 end submarket_pttrn from (select submarket from vz-it-pr-gudv-dtwndo-0.aid_dtwin_analytics_tbls_v.vzw_ltemarkets_tbl ) t ) y group by meas_dt
select current_date as meas_dt,sum(submarket_long_pttrn) as meas_value,current_timestamp load_ts from (select case when safe_cast(submarket_long as STRING) is not null then 0 else 1 end submarket_long_pttrn from (select submarket_long from vz-it-pr-gudv-dtwndo-0.aid_dtwin_analytics_tbls_v.vzw_ltemarkets_tbl ) t ) y group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(distinct concat(coalesce(cast(acct_num as string),""),"|",coalesce(cust_id,""),"|",coalesce(cust_line_seq_id,""))) cnt,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by acct_num,cust_id,cust_line_seq_id ,cast(trans_dt as date)) y group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(*) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,card ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_inventory_cards_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,card,trans_dt) group by meas_dt
select meas_dt, sum(cnt) as meas_value,current_timestamp load_ts from (select count(distinct concat(coalesce(device,""),"|",coalesce(card,""))) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,card ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_inventory_cards_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,card,trans_dt) group by meas_dt
select meas_dt, sum(cnt) as meas_value,current_timestamp load_ts from (select count(distinct coalesce(device,"")) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,vendor ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_inventory_devices_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,vendor,trans_dt) group by meas_dt
select meas_dt, sum(cnt) as meas_value, current_timestamp load_ts from (select count(*) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,vendor ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_inventory_devices_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,vendor,trans_dt) group by meas_dt
select cast(trans_dt as date) as meas_dt, count(*) as meas_value,current_timestamp load_ts from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_inventory_interfaces_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" group by 1
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(distinct concat(coalesce(device,""),"|",coalesce(intf,""),"|",coalesce(intf_type,""))) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,intf,intf_type ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_inventory_interfaces_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,intf,intf_type,trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(distinct concat(coalesce(device,""),"|",coalesce(connection_uid,""),"|",coalesce(connection_type,""))) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,connection_uid,connection_type ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_topology_network_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,connection_uid,connection_type,trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(*) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,connection_uid,connection_type ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.dim_topology_network_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,connection_uid,connection_type,trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value, current_timestamp load_ts from (select count(distinct concat(coalesce(device,""),"|",coalesce(remote_device,""),"|",coalesce(type,""),"|",coalesce(remote_type,""),"|",coalesce(intf,""),"|",coalesce(remote_intf,""))) cnt,cast(trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY device,remote_device,type,remote_type,intf,remote_intf ORDER BY cast(trans_dt as date) DESC) latest from vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_topology_tbls_v.dim_topology_network_ran_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by device,remote_device,type,remote_type,intf,remote_intf,trans_dt) group by meas_dt
select cast(trans_dt as date) as meas_dt, count(*) as meas_value,current_timestamp load_ts from vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_topology_tbls_v.dim_topology_network_ran_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" group by 1
select meas_dt,sum(rw_cnt) meas_value,current_timestamp load_ts from ( select cast(trans_dt as date) meas_dt,count(1) rw_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_alerts_alarm_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date)) as a group by meas_dt
select meas_dt,sum(unq_cnt) meas_value,current_timestamp load_ts from (select cast(trans_dt as date) meas_dt,count(distinct concat(coalesce(enodeb_id,""),"|",coalesce(alert_id,""),"|",coalesce(sector,""),"|",coalesce(carrier,""),"|",coalesce(cast(start_time as string),""),"|",coalesce(cast(end_time as string),""),"|",coalesce(cast(modified_time as string),""))) unq_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_alerts_alarm_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date)) as a group by meas_dt
SELECT meas_dt,sum(row_cnt) as meas_value,current_timestamp load_ts from (select cast(trans_dt as date) meas_dt,count(1) row_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_antenna_devices_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date) ) t group by meas_Dt
SELECT meas_dt,Sum(row_cnt) AS meas_value,Current_Timestamp load_ts,manufacturer,market_part AS Market,Coalesce(technology,"Unknown") technology FROM ( SELECT Cast(trans_dt AS DATE) meas_dt, internal_vendor AS Manufacturer,technology, Count(1) row_cnt,vendor,internal_market AS market_part FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_bbu_devices_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] GROUP BY Cast(trans_dt AS DATE),internal_vendor, technology,vendor,internal_market) t GROUP BY meas_dt,Manufacturer,market_part,Coalesce(technology, "Unknown")
SELECT meas_dt, Sum(serial_number) AS meas_value,Current_Timestamp load_ts,manufacturer,market_part AS Market,Coalesce(technology,"Unknown") technology FROM ( SELECT Cast(trans_dt AS DATE) meas_dt ,internal_vendor AS Manufacturer ,Count( DISTINCT serial_number) serial_number,Count(1) row_cnt,technology,internal_market AS market_part FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_bbu_devices_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] GROUP BY Cast(trans_dt AS DATE),internal_vendor,technology,internal_market) t GROUP BY meas_dt,Manufacturer,market_part,Coalesce(technology,"Unknown")
select meas_dt ,sum(row_cnt) as meas_value,current_timestamp load_ts, Manufacturer_Market as manufacturer,market_part as Market, coalesce(technology,"Unknown") technology from (select cast(trans_dt as date) meas_dt, internal_vendor as Manufacturer_Market,count(1) row_cnt,technology,internal_market as market_part,internal_vendor from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_enodeb_norm_v0 where cast(trans_dt as date)>="$START_DT" and cast(trans_dt as date)<="$END_DT" and trans_dt = split(cast(`_event_ingress_ts` as string)," ")[SAFE_OFFSET(0)]group by cast(trans_dt as date), internal_vendor,technology,internal_market) t group by meas_dt,Manufacturer_Market,market_part,coalesce(technology,"Unknown")
select meas_dt,sum(lte_market_name_pttrn) as meas_value,current_timestamp load_ts,Manufacturer_Market as manufacturer,market_part as Market,coalesce(technology,"Unknown") technology from (select Manufacturer_Market,market_part,technology,meas_dt,case when safe_cast(lte_market_name as STRING) is not null then 0 else 1 end lte_market_name_pttrn,lte_market_name from (select lte_market_name,cast(trans_dt as date) meas_dt,internal_vendor as Manufacturer_Market,internal_market as market_part,technology FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_enodeb_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,Manufacturer_Market,market_part,technology
select meas_dt,sum(enodeb_id_pttrn) as meas_value,current_timestamp load_ts,Manufacturer_Market as manufacturer,market_part as Market,coalesce(technology,"Unknown") technology from (select Manufacturer_Market,market_part,technology,meas_dt,case when safe_cast(enodeb_id as STRING) is not null then 0 else 1 end enodeb_id_pttrn,enodeb_id from (select enodeb_id,cast(trans_dt as date) meas_dt,internal_vendor as Manufacturer_Market,internal_market as market_part,technology FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_enodeb_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,Manufacturer_Market,market_part,technology
select meas_dt,sum(lte_market_id_pttrn) as meas_value,current_timestamp load_ts,Manufacturer_Market as manufacturer,market_part as Market,coalesce(technology,"Unknown") technology from (select Manufacturer_Market,market_part,technology,meas_dt,case when safe_cast(lte_market_id as STRING) is not null then 0 else 1 end lte_market_id_pttrn,lte_market_id from (select lte_market_id,cast(trans_dt as date) meas_dt,internal_vendor as Manufacturer_Market,internal_market as market_part,technology FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_enodeb_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,Manufacturer_Market,market_part,technology
SELECT meas_dt, sum(row_cnt) AS meas_value, current_timestamp load_ts FROM ( SELECT Cast(trans_dt AS DATE) meas_dt , count(1) row_cnt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_enodeb_site_map_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by Cast(trans_dt AS DATE)) t group by meas_dt
select meas_dt, count(site_id) as meas_value, current_timestamp load_ts from (select cast(trans_dt as date) meas_dt,sector,enodeb_id,gnb_du_id,carrier,coalesce(cast(site_id as string),"") site_id,alternate_site_id,alternate_system,row_number() over ( partition by cast(trans_dt as date),sector,site_id, enodeb_id,gnb_du_id,carrier,alternate_site_id,alternate_system) dupe from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_enodeb_site_map_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] ) t where dupe = 1 group by meas_dt
select meas_dt,sum(sector_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when safe_cast(sector as INT64) is not null then 0 else 1 end sector_pttrn,sector from (select sector,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_enodeb_site_map_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt
SELECT meas_dt,sum(row_cnt) AS meas_value,current_timestamp load_ts FROM ( SELECT Cast(trans_dt AS DATE) meas_dt ,count(1) row_cnt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_project_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by Cast(trans_dt AS DATE)) t group by meas_dt
SELECT meas_dt,sum(project_id) AS meas_value,current_timestamp load_ts FROM ( SELECT Cast(trans_dt AS DATE) meas_dt ,count(distinct concat(coalesce(project_id, ""),"|",coalesce(site_id,""))) project_id,site_id FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_project_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by Cast(trans_dt AS DATE),site_id) t group by meas_dt
select meas_dt ,sum(row_cnt) as meas_value,current_timestamp load_ts,Manufacturer_Market as manufacturer,market_part as Market,coalesce(technology,"Unknown") technology from (select cast(trans_dt as date) meas_dt, internal_vendor as Manufacturer_Market, count(1) row_cnt , technology,internal_market as market_part from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_radio_bbu_antenna_assignment_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt =split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date) ,internal_vendor ,technology,internal_market) t group by meas_dt,Manufacturer_Market,market_part,technology
select meas_dt, sum(antenna_uid) as meas_value,current_timestamp load_ts, Manufacturer_Market as manufacturer,market_part as Market,coalesce(technology,"Unknown") technology from (select cast(trans_dt as date) meas_dt,internal_vendor as Manufacturer_Market,count(distinct concat(coalesce(antenna_uid,""),"|",coalesce(bbu_uid,""),"|",coalesce(cast(carrier as string),""),"|",coalesce(enodeb_id,""),"|",coalesce(gnb_du_id,""),"|",coalesce(gnb_fsu_id,""),"|",coalesce(radio_uid,""),"|",coalesce(cast(sector as string),""))) antenna_uid, count(1) row_cnt,coalesce(technology,"Unknown") technology ,vendor,enodeb_id,radio_uid,carrier,sector,internal_market as market_part from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_radio_bbu_antenna_assignment_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date), internal_vendor,technology,vendor,enodeb_id,radio_uid,carrier, sector,internal_market) t group by meas_dt,Manufacturer_Market,market_part,coalesce(technology,"Unknown")
select meas_dt, sum(row_cnt) as meas_value, current_timestamp load_ts, Manufacturer_Market as manufacturer, market_part as Market, coalesce(technology, "Unknown") technology from ( select cast(trans_dt as date) meas_dt, internal_vendor as Manufacturer_Market, technology,vendor,internal_market as market_part, count(1) row_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_radio_bbu_antenna_unassigned_norm_v0 where cast(trans_dt as date)>= "$START_DT" and cast(trans_dt as date)<= "$END_DT" and trans_dt = split(cast(`_event_ingress_ts` as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date), internal_vendor, technology,vendor, internal_market) t group by meas_dt, Manufacturer_Market, market_part, coalesce(technology, "Unknown")
select meas_dt, sum(row_cnt) as meas_value, current_timestamp load_ts, Manufacturer_Market as manufacturer, market_part as Market, coalesce(technology, "Unknown") technology from ( select cast(trans_dt as date) meas_dt, internal_vendor as Manufacturer_Market, technology,vendor,internal_market as market_part, count(1) row_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_radio_cell_unassigned_norm_v0 where cast(trans_dt as date)>= "$START_DT" and cast(trans_dt as date)<= "$END_DT" and trans_dt = split(cast(`_event_ingress_ts` as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date), internal_vendor, technology,vendor, internal_market) t group by meas_dt, Manufacturer_Market, market_part, coalesce(technology, "Unknown")
select meas_dt, sum(row_cnt) as meas_value, current_timestamp load_ts, Manufacturer_Market as manufacturer,market_part as Market, coalesce(technology, "Unknown") technology from ( select cast(trans_dt as date) meas_dt, internal_vendor as Manufacturer_Market,technology,count(1) row_cnt,vendor,internal_market as market_part from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_radio_devices_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date),internal_vendor,technology,vendor, internal_market) t group by meas_dt,Manufacturer_Market,market_part,coalesce(technology, "Unknown")
select meas_dt,sum(device_uid_distcnt) as meas_value,current_timestamp load_ts,Manufacturer_Market as manufacturer,market_part as Market,coalesce(technology,"Unknown") technology from( select cast(trans_dt as date) meas_dt ,internal_vendor as Manufacturer_Market ,technology ,count( distinct device_uid) device_uid_distcnt,count(1) row_cnt,vendor,internal_market as market_part from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_inventory_radio_devices_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date), internal_vendor, technology,vendor,internal_market) t group by meas_dt,Manufacturer_Market,market_part,coalesce(technology,"Unknown")
SELECT meas_dt, sum(prop_id_uniq) as meas_value,current_timestamp load_ts from ( select cast(trans_dt as date) meas_dt,count(distinct concat(coalesce(property_id, ""),"|",coalesce(energy_id,""),"|",coalesce(month,""),"|",coalesce(year, ""),"|",coalesce(meter_num,""))) prop_id_uniq,property_id from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_performance_energy_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by cast(trans_dt as date),property_id)el group by meas_dt
SELECT meas_dt, sum(row_cnt) AS meas_value,current_timestamp load_ts FROM (SELECT Cast(trans_dt AS DATE) meas_dt ,count(1) row_cnt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_performance_energy_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by Cast(trans_dt AS DATE)) t group by meas_dt
select meas_dt,sum(rw_cnt) meas_value,current_timestamp load_ts from (select cast(trans_dt as date) meas_dt,count(1) rw_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_ran_commontickets_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date)) as a group by meas_dt
select meas_dt,sum(unq_cnt) meas_value,current_timestamp load_ts from (select cast(trans_dt as date) meas_dt,count(distinct concat(coalesce(request_id,""),"|",coalesce(parent_ticket,""),"|",coalesce(cast(site_id as string),""),"|",coalesce(cast(start_time as string),""),"|",coalesce(cast(end_time as string),""),"|",coalesce(cast(modified_date as string),""))) unq_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_ran_commontickets_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date)) as a group by meas_dt
SELECT meas_dt, sum(row_cnt) AS meas_value, current_timestamp load_ts FROM ( SELECT Cast(trans_dt AS DATE) meas_dt , count(1) row_cnt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_realestate_contract_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by Cast(trans_dt AS DATE)) t group by meas_dt
SELECT meas_dt, sum(cnt_uniq) AS meas_value,current_timestamp load_ts FROM (SELECT Cast(trans_dt AS DATE) meas_dt ,count(distinct concat(coalesce(contract_id,""),"|",coalesce(property_id,""))) cnt_uniq, contract_id FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_realestate_contract_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by Cast(trans_dt AS DATE),contract_id union all select cast(current_date as date) meas_dt, 0 as meas_value, "" contract_id ) t group by meas_dt
SELECT meas_dt, sum(row_cnt) AS meas_value, current_timestamp load_ts FROM ( SELECT Cast(trans_dt AS DATE) meas_dt ,count(1) row_cnt,property_id FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_realestate_property_norm_v0 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by Cast(trans_dt AS DATE),property_id) t group by meas_dt
SELECT meas_dt,sum(prop_id_uniq) as meas_value, current_timestamp load_ts from ( select cast(trans_dt as date) meas_dt,count(distinct concat(coalesce(property_id, ""),"|",coalesce(property_ownership,""))) prop_id_uniq from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_realestate_property_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and trans_dt = split(cast(_event_ingress_ts as string)," ")[SAFE_OFFSET(0)] group by cast(trans_dt as date))el group by meas_dt
select meas_dt,meas_hr,sum(cnt) meas_value,current_timestamp load_ts from ( select cast(trans_dt as date) meas_dt,safe_cast(hr as integer) as meas_hr,count(1) cnt from vz-it-pr-i37v-ndldo-0.vzn_ndl_truecall_core_tbls_v.lsr_raw_v1 WHERE Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by cast(trans_dt as date),safe_cast(hr as integer)) as a group by meas_dt,meas_hr
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(*) cnt,cast(Trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY Trans_dt ORDER BY cast(Trans_dt as date) DESC) latest from vz-it-pr-i37v-ndldo-0.vzn_ndl_brix_core_tbls_v.ebh_15mins_raw_v1 where Cast(Trans_dt as date)>= "$START_DT" AND Cast(Trans_dt as date)<="$END_DT" group by Trans_dt,Trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(*) cnt,cast(Trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY Trans_dt ORDER BY cast(Trans_dt as date) DESC) latest from vz-it-pr-i37v-ndldo-0.vzn_ndl_cnc_app_tbls_v.score_details_proc_v1 where Cast(Trans_dt as date)>= "$START_DT" AND Cast(Trans_dt as date)<="$END_DT" group by Trans_dt,Trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(*) cnt,cast(Trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY Trans_dt ORDER BY cast(Trans_dt as date) DESC) latest from vz-it-pr-i37v-ndldo-0.vzn_ndl_vpi_core_tbls_v.carrier_location_raw_v1 where Cast(Trans_dt as date)>= "$START_DT" AND Cast(Trans_dt as date)<="$END_DT" group by Trans_dt,Trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(*) cnt,cast(Trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY Trans_dt ORDER BY cast(Trans_dt as date) DESC) latest from vz-it-pr-i37v-ndldo-0.vzn_ndl_vpi_core_tbls_v.sectorcarrier_hourly_raw_v2 where Cast(Trans_dt as date)>= "$START_DT" AND Cast(Trans_dt as date)<="$END_DT" group by Trans_dt,Trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(*) cnt,cast(Trans_dt as date) as meas_dt,ROW_NUMBER() OVER (PARTITION BY Trans_dt ORDER BY cast(Trans_dt as date) DESC) latest from vz-it-pr-i37v-ndldo-0.vzn_ndl_vzatoll_core_tbls_v.lte_topology_raw_v4 where Cast(Trans_dt as date)>= "$START_DT" AND Cast(Trans_dt as date)<="$END_DT" group by Trans_dt,Trans_dt) group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(1) cnt,cast(trans_dt as date) as meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by acct_num,cust_id,cust_line_seq_id,cast(trans_dt as date)) group by meas_dt
select meas_dt,sum(active_status_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(active_status as string) is not null AND safe_cast(active_status as integer)<=1 then 0 else 1 end active_status_pttrn from (select active_status,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT") t ) y group by meas_dt
select meas_dt,sum(number_of_calls_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(number_of_calls as INT64) is not null then 0 else 1 end number_of_calls_pttrn,number_of_calls from (select technology,number_of_calls,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(mean_sinr_pattrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select mean_sinr,case when (upper(technology) like "%LTE%" or upper(technology) like "%NW%") and (mean_sinr>=-45 and mean_sinr<=37) then 0 when (upper(technology) like "%CBAND%" or upper(technology) like "%UWB%") and (mean_sinr>=-20 and mean_sinr<=37) then 0 else 1 end mean_sinr_pattrn ,cast(trans_dt as date) meas_dt,technology from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and technology is not null) t group by meas_dt,technology
select meas_dt,sum(average_rsrp_pattrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select average_rsrp,case when (upper(technology) like "%4G%" and upper(technology) like "%LTE%") and (average_rsrp>=-153 and average_rsrp<=-40) then 0 when upper(technology) like "%5G%" and (average_rsrp>=-157 and average_rsrp<=-30) then 0 else 1 end average_rsrp_pattrn ,cast(trans_dt as date) meas_dt,technology from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and technology is not null) t group by meas_dt,technology
select meas_dt,sum(mean_end_distance_to_site_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(mean_end_distance_to_site as float64) is not null then 0 else 1 end mean_end_distance_to_site_pttrn,mean_end_distance_to_site from (select mean_end_distance_to_site,cast(trans_dt as date) meas_dt,technology FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(enodeb_id_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(enodeb_id as STRING) is not null and (length(enodeb_id)=6 or length(enodeb_id)=7) then 0 else 1 end enodeb_id_pttrn,enodeb_id from (select technology,enodeb_id,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market, coalesce(technology,"Unknown") technology from (select count(concat(coalesce(cast(event_time as string),""),"|",coalesce(cast(technology as string),""),"|",coalesce(cast(enodeb_id as string),""),"|",coalesce(cast(sector as string),""),"|",coalesce(cast(carrier as string),""),"|",coalesce(cast(channel as string),""),"|",coalesce(cast(imsi as string),""))) cnt,cast(trans_dt as date) meas_dt,technology FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" group by event_time,technology,enodeb_id,sector,carrier,channel,imsi,cast(trans_dt as date)) y group by meas_dt,technology
select meas_dt,sum(number_of_connections_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(number_of_connections as INT64) is not null then 0 else 1 end number_of_connections_pttrn,number_of_connections from (select technology,number_of_connections,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(sector_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(sector as INT64) is not null then 0 else 1 end sector_pttrn,sector from (select technology,sector,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(dropped_connections_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(dropped_connections as INT64) is not null then 0 else 1 end dropped_connections_pttrn,dropped_connections from (select technology,dropped_connections,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(dropped_calls_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(dropped_calls as INT64) is not null then 0 else 1 end dropped_calls_pttrn,dropped_calls from (select dropped_calls,cast(trans_dt as date) meas_dt,technology from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(carrier_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(carrier as INT64) is not null then 0 else 1 end carrier_pttrn,carrier from (select technology,carrier,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(voice_releases_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(voice_releases as INT64) is not null then 0 else 1 end voice_releases_pttrn,voice_releases from (select technology,voice_releases,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(event_time) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select meas_dt,case when REGEXP_CONTAINS(cast(event_time as string),"^[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}$") and event_time is not null then 0 else 1 end event_time,technology from (select event_time ,cast(trans_dt as date) meas_dt,technology FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(technology_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select meas_dt,case when safe_cast(technology as STRING) is not null and upper(technology) like any ("4G_LTE","5G_UWB","5G_CBAND","5G_NW") then 0 else 1 end technology_pttrn,technology from (select technology,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(average_rsrq_pattrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select case when upper(technology) like "%LTE%" and (average_rsrq>=-35 and average_rsrq<=-3) then 0 when upper(technology) like "%5G%" and (average_rsrq>=-43.5 and average_rsrq<=20) then 0 else 1 end average_rsrq_pattrn ,cast(trans_dt as date) meas_dt,technology from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" and technology is not null) t group by meas_dt,technology
select meas_dt,sum(duration_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(duration as float64) is not null then 0 else 1 end duration_pttrn,duration from (select technology,duration,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(data_releases_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(data_releases as INT64) is not null then 0 else 1 end data_releases_pttrn,data_releases from (select technology,data_releases,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
select meas_dt,sum(qci9_count_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(qci9_count as INT64) is not null then 0 else 1 end qci9_count_pttrn,qci9_count from (select technology,qci9_count,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt,technology
"select meas_dt,sum(rw_cnt) meas_value,current_timestamp load_ts
  from (
    select PARSE_DATE(""%Y%m%d"", SUBSTR(event_time, 0 , 8)) meas_dt,count(1) rw_cnt
      from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_performance_network_norm_v0
     WHERE Cast(trans_dt AS DATE)>= ""$START_DT""
       AND event_time LIKE CONCAT(FORMAT_DATE(""%Y%m%d"", ""$START_DT""), ""%"")
     group by 1
  ) as a group by meas_dt"
"select meas_dt,sum(unq_cnt) meas_value,current_timestamp load_ts
  from (
    select PARSE_DATE(""%Y%m%d"", SUBSTR(event_time, 0 , 8)) meas_dt,count(distinct concat(coalesce(hour,""""),""|"",
           coalesce(enodeb_id,""""), ""|"",coalesce(cast(sector as string),""""),""|"",
           coalesce(gnb_du_id,""""),""|"",coalesce(cast(carrier as string),""""),""|"",
           coalesce(cast(event_time as string),""""))) unq_cnt
      from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_performance_network_norm_v0
     WHERE Cast(trans_dt AS DATE)>= ""$START_DT""
       AND event_time LIKE CONCAT(FORMAT_DATE(""%Y%m%d"", ""$START_DT""), ""%"")
     group by 1) as a group by meas_dt"
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(concat(coalesce(event_time,""),"|",coalesce(device,""),"|",coalesce(partner_name,""),"|",coalesce(switch_name,""),"|",coalesce(verifier_name,""),"|",coalesce(mac,""))) cnt,cast(trans_dt as date) meas_dt,row_number() over (partition by event_time,device,partner_name,switch_name,verifier_name,mac order by cast(trans_dt as date) desc) latest FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y" group by event_time,device,partner_name,switch_name,verifier_name,mac,cast(trans_dt as date)) y group by meas_dt
select meas_dt,sum(pbit0_fl_path_2_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fl_path_2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit0_fl_path_2 as string), r"^{0,100}$") then 0 else 1 end pbit0_fl_path_2_pttrn,pbit0_fl_path_2 from (select pbit0_fl_path_2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fdv_max_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fdv_max as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fdv_max as integer)>=0 then 0 else 1 end pbit0_fdv_max_pttrn,pbit0_fdv_max from (select pbit0_fdv_max,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(mac_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(mac as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" then 0 else 1 end mac_pttrn,mac from (select mac,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fdv_avg_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fdv_avg_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fdv_avg_path2 as integer)>=0 then 0 else 1 end pbit5_fdv_avg_path2_pttrn,pbit5_fdv_avg_path2 from (select pbit5_fdv_avg_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(partner_name_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(partner_name as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" then 0 else 1 end partner_name_pttrn,partner_name from (select partner_name,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fd_avg_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fd_avg_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fd_avg_path2 as integer)>=0 then 0 else 1 end pbit0_fd_avg_path2_pttrn,pbit0_fd_avg_path2 from (select pbit0_fd_avg_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fd_max_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fd_max as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fd_max as integer)>=0 then 0 else 1 end pbit5_fd_max_pttrn,pbit5_fd_max from (select pbit5_fd_max,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fd_avg_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fd_avg_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fd_avg_path1 as integer)>=0 then 0 else 1 end pbit0_fd_avg_path1_pttrn,pbit0_fd_avg_path1 from (select pbit0_fd_avg_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fd_max_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fd_max_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fd_max_path1 as integer)>=0 then 0 else 1 end pbit0_fd_max_path1_pttrn,pbit0_fd_max_path1 from (select pbit0_fd_max_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fd_avg_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fd_avg_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fd_avg_path1 as integer)>=0 then 0 else 1 end pbit5_fd_avg_path1_pttrn,pbit5_fd_avg_path1 from (select pbit5_fd_avg_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(device_pttrn) as meas_value,current_timestamp load_ts from (select case when cast(device as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" then 0 else 1 end device_pttrn,device,meas_dt from (select device,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fdv_max_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fdv_max_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fdv_max_path2 as integer)>=0 then 0 else 1 end pbit5_fdv_max_path2_pttrn,pbit5_fdv_max_path2 from (select pbit5_fdv_max_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fl_path_1_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fl_path_1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit0_fl_path_1 as string), r"^{0,100}$") then 0 else 1 end pbit0_fl_path_1_pttrn,pbit0_fl_path_1 from (select pbit0_fl_path_1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fl_path_2_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fl_path_2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit5_fl_path_2 as string), r"^{0,100}$") then 0 else 1 end pbit5_fl_path_2_pttrn,pbit5_fl_path_2 from (select pbit5_fl_path_2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fdv_max_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fdv_max as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fdv_max as integer)>=0 then 0 else 1 end pbit5_fdv_max_pttrn,pbit5_fdv_max from (select pbit5_fdv_max,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_avail_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_avail as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit5_avail as string), r"^{0,100}$") then 0 else 1 end pbit5_avail_pttrn,pbit5_avail from (select pbit5_avail,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fdv_avg_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fdv_avg_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fdv_avg_path2 as integer)>=0 then 0 else 1 end pbit0_fdv_avg_path2_pttrn,pbit0_fdv_avg_path2 from (select pbit0_fdv_avg_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(event_dt) as meas_value,current_timestamp load_ts from (select meas_dt,case when REGEXP_CONTAINS(cast(event_time_utc as string),"^[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}$") and event_time_utc is not null then 0 else 1 end event_dt from (select event_time_utc,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fl_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fl as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit5_fl as string), r"^{0,100}$") then 0 else 1 end pbit5_fl_pttrn,pbit5_fl from (select pbit5_fl,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fd_max_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fd_max_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fd_max_path2 as integer)>=0 then 0 else 1 end pbit5_fd_max_path2_pttrn,pbit5_fd_max_path2 from (select pbit5_fd_max_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fdv_avg_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fdv_avg_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fdv_avg_path1 as integer)>=0 then 0 else 1 end pbit0_fdv_avg_path1_pttrn,pbit0_fdv_avg_path1 from (select pbit0_fdv_avg_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fl_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fl as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit0_fl as string), r"^{0,100}$") then 0 else 1 end pbit0_fl_pttrn,pbit0_fl from (select pbit0_fl,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fdv_max_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fdv_max_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fdv_max_path1 as integer)>=0 then 0 else 1 end pbit5_fdv_max_path1_pttrn,pbit5_fdv_max_path1 from (select pbit5_fdv_max_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(switch_name_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(switch_name as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" then 0 else 1 end switch_name_pttrn,switch_name from (select switch_name,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(verifier_name_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(verifier_name as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" then 0 else 1 end verifier_name_pttrn,verifier_name from (select verifier_name,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fd_max_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fd_max_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fd_max_path2 as integer)>=0 then 0 else 1 end pbit0_fd_max_path2_pttrn,pbit0_fd_max_path2 from (select pbit0_fd_max_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
"select meas_dt,sum(event_time_pttrn) as meas_value,current_timestamp load_ts 
  from (
    select meas_dt,case when REGEXP_CONTAINS(cast(event_time as string), ""^[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}$"") and event_time is not null then 0 else 1 end event_time_pttrn 
      from (
        select event_time ,cast(Trans_dt as date) meas_dt 
          FROM  vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 
         where Cast(Trans_dt AS DATE)>= ""$START_DT"" 
           AND Cast(Trans_dt AS DATE)<=""$END_DT"" 
           AND active_flag = ""Y""
        ) t 
    ) y group by meas_dt"
select meas_dt,sum(test_cnt_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(test_cnt as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(test_cnt as string), r"^{0,3}$") then 0 else 1 end test_cnt_pttrn,test_cnt from (select test_cnt,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fl_path_1_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fl_path_1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit5_fl_path_1 as string), r"^{0,100}$") then 0 else 1 end pbit5_fl_path_1_pttrn,pbit5_fl_path_1 from (select pbit5_fl_path_1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fd_avg_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fd_avg_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fd_avg_path2 as integer)>=0 then 0 else 1 end pbit5_fd_avg_path2_pttrn,pbit5_fd_avg_path2 from (select pbit5_fd_avg_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fdv_avg_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fdv_avg_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fdv_avg_path1 as integer)>=0 then 0 else 1 end pbit5_fdv_avg_path1_pttrn,pbit5_fdv_avg_path1 from (select pbit5_fdv_avg_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt, sum(pbit0_avail_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_avail as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and REGEXP_CONTAINS(cast(pbit0_avail as string), r"^{0,100}$") then 0 else 1 end pbit0_avail_pttrn,pbit0_avail from (select pbit0_avail,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fd_max_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fd_max as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fd_max as integer)>=0 then 0 else 1 end pbit0_fd_max_pttrn,pbit0_fd_max from (select pbit0_fd_max,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fd_max_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fd_max_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fd_max_path1 as integer)>=0 then 0 else 1 end pbit5_fd_max_path1_pttrn,pbit5_fd_max_path1 from (select pbit5_fd_max_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fdv_max_path1_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fdv_max_path1 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fdv_max_path1 as integer)>=0 then 0 else 1 end pbit0_fdv_max_path1_pttrn,pbit0_fdv_max_path1 from (select pbit0_fdv_max_path1,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fd_avg_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fd_avg as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fd_avg as integer)>=0 then 0 else 1 end pbit0_fd_avg_pttrn,pbit0_fd_avg from (select pbit0_fd_avg,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fdv_avg_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fdv_avg as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fdv_avg as integer)>=0 then 0 else 1 end pbit0_fdv_avg_pttrn,pbit0_fdv_avg from (select pbit0_fdv_avg,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fdv_avg_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fdv_avg as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fdv_avg as integer)>=0 then 0 else 1 end pbit5_fdv_avg_pttrn,pbit5_fdv_avg from (select pbit5_fdv_avg,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit5_fd_avg_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit5_fd_avg as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit5_fd_avg as integer)>=0 then 0 else 1 end pbit5_fd_avg_pttrn,pbit5_fd_avg from (select pbit5_fd_avg,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
select meas_dt,sum(pbit0_fdv_max_path2_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(pbit0_fdv_max_path2 as string) not like "^[0-9]\\d{0,2}(\\.\\d{1,2})?|NULL$" and cast(pbit0_fdv_max_path2 as integer)>=0 then 0 else 1 end pbit0_fdv_max_path2_pttrn,pbit0_fdv_max_path2 from (select pbit0_fdv_max_path2,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT" AND active_flag = "Y") t ) y group by meas_dt
SELECT CAST("$START_DT" AS DATE) meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, "NA" manufacturer,       LPAD(base.lte_market_id, 3, "0") AS market, "NA" technology    FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_analytics_tbls_v.vzw_ltemarkets_tbl base  LEFT JOIN (    select meas_dt,market, sum(rw_cnt) meas_value,       from (         select PARSE_DATE("%Y%m%d", SUBSTR(event_time, 0 , 8)) meas_dt, market, count(1) rw_cnt           from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_performance_network_norm_v0          WHERE Cast(trans_dt AS DATE) >= "$START_DT"           AND event_time LIKE CONCAT(FORMAT_DATE("%Y%m%d", "$START_DT" ), "%") group by 1, 2      ) as a     group by meas_dt, market order by market DESC  ) counts ON LPAD(base.lte_market_id, 3, "0") = counts.market
SELECT CAST("$START_DT" AS DATE) meas_dt, SUM(meas_value) AS meas_value, current_timestamp load_ts,        "NA" manufacturer, submarket market, "NA" technology  FROM (    SELECT base.submarket, a.meas_dt, COALESCE(a.rw_cnt, 0) AS meas_value      FROM (        SELECT DISTINCT submarket           FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_analytics_tbls_v.vzw_ltemarkets_tbl        ) AS base        LEFT JOIN          (SELECT trans_dt meas_dt,                  CASE WHEN submkt = "CARTN" THEN "CATN"                       WHEN submkt = "GA" THEN "GAAL"                       WHEN submkt = "MINKY" THEN "MIK"                       WHEN submkt = "NCAL" THEN "NCA"                       WHEN submkt = "OHPA" THEN "OPW"                       WHEN submkt = "SCAL" THEN "SCA"                       WHEN submkt = "UNY" THEN "UPNY"                       ELSE submkt                   END AS submkt,                   count(1) rw_cnt             FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_truecall_core_tbls_v.qos_performance_customer_dtl            WHERE CAST(trans_dt AS DATE) = "$START_DT"            GROUP BY 1, 2          ) AS a        ON base.submarket = a.submkt      )      GROUP BY submarket
select meas_dt, sum(rw_cnt) meas_value, current_timestamp load_ts from ( select cast(trans_dt as date) as meas_dt, count(1) rw_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_fwa_core_tbls_v.fwa_active_customer_performance_daily_norm WHERE Cast(trans_dt AS DATE) = "$START_DT" group by 1 ) as a group by meas_dt
select meas_dt, sum(rw_cnt) meas_value, current_timestamp load_ts from ( select trans_dt meas_dt, count(1) rw_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.customer_connectivity_performance_detail_norm WHERE Cast(trans_dt AS DATE) = "$START_DT" group by 1 ) as a group by meas_dt
select meas_dt, sum(rw_cnt) meas_value, current_timestamp load_ts from ( select trans_dt meas_dt, count(1) rw_cnt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.customer_connectivity_performance_summary_norm WHERE Cast(trans_dt AS DATE) = "$START_DT" group by 1 ) as a group by meas_dt
SELECT trans_dt AS meas_dt, COUNTIF(hrcount != 24) AS meas_value, CURRENT_TIMESTAMP() load_ts FROM ( SELECT trans_dt, device_name, COUNT(DISTINCT trans_hr) AS hrcount FROM ( SELECT trans_dt, trans_hr, device_name, SUM(messages_count) AS messagecount FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_kpi_device_ip_address_audit WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1, 2, 3 HAVING messagecount > 0 ) GROUP BY 1, 2 ) GROUP BY 1
SELECT trans_dt AS meas_dt, SUM(messages_count) AS meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_kpi_device_ip_address_audit WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
"select meas_dt,sum(dl_prb_util_pct_pttrn) as meas_value,current_timestamp load_ts
  from (
    select meas_dt,
           case when safe_cast(dl_prb_util_pct as float64) is null
                     OR (dl_prb_util_pct=0 AND avg_conn_users>1)
                     OR dl_prb_util_pct < 0
                     OR dl_prb_util_pct > 100 then 1 else 0
            end dl_prb_util_pct_pttrn, dl_prb_util_pct
      from (
        select dl_prb_util_pct, avg_conn_users, PARSE_DATE(""%Y%m%d"", SUBSTR(event_time, 0 , 8)) meas_dt
          FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_performance_network_norm_v0
         where Cast(trans_dt AS DATE)>= ""$START_DT""
           AND event_time LIKE CONCAT(FORMAT_DATE(""%Y%m%d"", ""$START_DT""), ""%"")
      ) t
  ) y group by meas_dt"
select meas_dt,sum(device_generation_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(device_generation as string) is not null AND (upper(device_generation) like "%4G%" or upper(device_generation) like "%5G%") then 0 else 1 end device_generation_pttrn from (select device_generation,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" ) t ) y group by meas_dt
select meas_dt,sum(device_type_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(device_type as string) is null or safe_cast(device_type as string) like "[^0-9]" then 1 else 0 end device_type_pttrn from (select device_type,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE)>= "$START_DT" AND Cast(trans_dt AS DATE)<="$END_DT") t ) y group by meas_dt
select meas_dt,sum(imsi_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when safe_cast(imsi as INT64) is not null AND length(imsi) = 15 then 0 else 1 end imsi_pttrn,imsi from (select imsi,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT") t ) y group by meas_dt
select meas_dt,sum(is_always_qci8_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(is_always_qci8 as string) is not null AND REGEXP_CONTAINS(safe_cast(is_always_qci8 as string), r"^{0,1}$") then 0 else 1 end is_always_qci8_pttrn from (select is_always_qci8,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT") t) y group by meas_dt
select meas_dt,sum(is_fwa_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(is_fwa as string) is not null AND REGEXP_CONTAINS(cast(is_fwa as string), r"^{0,1}$") then 0 else 1 end is_fwa_pttrn from (select is_fwa,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" ) t ) y group by meas_dt
select meas_dt,sum(is_prepaid_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(is_prepaid as string) is not null AND (upper(is_prepaid) like "%Y%" or upper(is_prepaid) like "%N%") then 0 else 1 end is_prepaid_pttrn from (select is_prepaid,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT"  ) t ) y group by meas_dt
select meas_dt,sum(is_test_line_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when safe_cast(is_test_line as string) is not null AND (upper(is_test_line) like "%Y%" or upper(is_test_line) like "%N%") then 0 else 1 end is_test_line_pttrn from (select is_test_line,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" ) t ) y group by meas_dt
select meas_dt,sum(is_unlimited_plan_pttrn)as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(is_unlimited_plan as string) is not null AND REGEXP_CONTAINS(cast(is_unlimited_plan as string), r"^{0,1}$") then 0 else 1 end is_unlimited_plan_pttrn from (select is_unlimited_plan,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT") t ) y group by meas_dt
select meas_dt,sum(qci_plan_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when safe_cast(qci_plan as string) is not null AND (upper(qci_plan) like "%QCI8%" or upper(qci_plan) like "%QCI9%") then 0 else 1 end qci_plan_pttrn,qci_plan from (select qci_plan,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_v.customer_attributes_daily_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" ) t ) y group by meas_dt
select cast(trans_dt as date) as meas_dt, count(*) as meas_value,current_timestamp load_ts from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.qos_performance_hourly_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" AND active_flag = "Y" group by 1
"select cast(trans_dt as date) meas_dt, count(*) as meas_value,current_timestamp load_ts,""NA"" manufacturer,""NA"" market, coalesce(technology,""Unknown"") technology from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE) = ""$START_DT"" 
   group by meas_dt,technology"
select meas_dt,sum(mean_cqi_pattrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market, coalesce(technology,"Unknown") technology from (select case when technology is not null and (mean_cqi>=0 and mean_cqi<=15) then 0 else 1 end mean_cqi_pattrn ,technology,cast(trans_dt as date) meas_dt from vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT" and technology is not null) t group by meas_dt,technology
select meas_dt,sum(imsi_pttrn) as meas_value,current_timestamp load_ts,"NA" manufacturer,"NA" market,coalesce(technology,"Unknown") technology from (select technology,meas_dt,case when safe_cast(imsi as INT64) is not null AND LENGTH(imsi) = 15 then 0 else 1 end imsi_pttrn,imsi from (select technology,imsi,cast(trans_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 where Cast(trans_dt AS DATE) = "$START_DT") t ) y group by meas_dt,technology
SELECT CAST("$START_DT" AS DATE) meas_dt, SUM(meas_value) AS meas_value, current_timestamp load_ts, "NA" manufacturer, submarket market, "NA" technology FROM ( SELECT base.submarket, a.meas_dt, COALESCE(a.rw_cnt, 0) AS meas_value FROM ( SELECT DISTINCT submarket FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_analytics_tbls_v.vzw_ltemarkets_tbl ) AS base LEFT JOIN (SELECT trans_dt meas_dt, CASE WHEN submarket = "CARTN" THEN "CATN" WHEN submarket = "GA" THEN "GAAL" WHEN submarket = "MINKY" THEN "MIK" WHEN submarket = "NCAL" THEN "NCA" WHEN submarket = "OHPA" THEN "OPW" WHEN submarket = "SCAL" THEN "SCA" WHEN submarket = "UNY" THEN "UPNY" ELSE submarket END AS submkt, count(1) rw_cnt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.qos_performance_customer_hourly_norm_v0 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1, 2 ) AS a ON base.submarket = a.submkt ) GROUP BY submarket
"SELECT CAST(""$START_DT"" AS DATE) meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, ""NA"" manufacturer,
       submarket AS market, ""NA"" technology  
  FROM (
    SELECT meas_dt, submarket, sum(rw_cnt) meas_value, 
      FROM ( 
        SELECT base.submarket, meas_dt, rw_cnt
          FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_analytics_tbls_v.vzw_ltemarkets_tbl base
        LEFT JOIN
          (SELECT PARSE_DATE(""%Y%m%d"", SUBSTR(event_time, 0 , 8)) meas_dt, market, count(1) rw_cnt 
             FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.dim_performance_network_norm_v0 
           WHERE Cast(trans_dt AS DATE) >= ""$START_DT""
             AND event_time LIKE CONCAT(FORMAT_DATE(""%Y%m%d"", ""$START_DT""), ""%"") group by 1, 2) counts
        ON  LPAD(base.lte_market_id, 3, '0') = counts.market 
        WHERE meas_dt IS NOT NULL    
      ) as a 
    group by meas_dt, submarket
  )"
SELECT cast(day as date) AS meas_dt, COUNTIF(qci8_count IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_preagg_hourly_norm WHERE cast(trans_dt as date) >= "$START_DT" AND cast(day as date) = "$START_DT" GROUP BY 1
SELECT cast(day as date) AS meas_dt, COUNTIF(imsi IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_preagg_hourly_norm WHERE cast(trans_dt as date) >= "$START_DT" AND cast(day as date) = "$START_DT" GROUP BY 1
SELECT cast(day as date) AS meas_dt, COUNTIF(qci9_count IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_preagg_hourly_norm WHERE cast(trans_dt as date) >= "$START_DT" AND cast(day as date) = "$START_DT" GROUP BY 1
SELECT cast(day as date) AS meas_dt, COUNT(*) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_preagg_hourly_norm WHERE cast(trans_dt as date) >= "$START_DT" AND cast(day as date) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(DISTINCT trans_hr) AS meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_hourly_v1 WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(DISTINCT trans_hr) AS meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_kpi_hourly_v1 WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(DISTINCT trans_hr) AS meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_ksi_hourly_v1 WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(DISTINCT trans_hr) AS meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls.lte_metrics_user_plane_hourly_v1 WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(DISTINCT trans_hr) AS meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls.media_metrics_kpi_hourly_v1 WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(DISTINCT trans_hr) AS meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls.metrics_kei_hourly_v1 WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(DISTINCT trans_hr) AS meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls.volte_metrics_kpi_hourly WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(apn_name  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(application_name  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(application_protocol_type_code  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(cell_id  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(cell_mcc  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(cell_mnc  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(client_server_entry_type_name  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(destination_node IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(device_name  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer, application_name AS market, count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2, 3 )
SELECT trans_dt_ct meas_dt, countif(procedure IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(rat_name  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(response_code  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(response_description  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(destination_node IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(trackingarea_code  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(userequipment_manufacturer_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt_ct meas_dt, countif(userequipment_model_name  IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_daily_v1 WHERE CAST(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(technology IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(region IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(market_id IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(enodeb_id IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, market, "NA" technology FROM ( SELECT CAST(trans_dt AS DATE) AS meas_dt, source AS manufacturer, cache_algorithm AS market, count(1) AS meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1, 2, 3 )
SELECT trans_dt meas_dt, countif(sector IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(device_latitude IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(imsi IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(ta_distance IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, countif(device_longitude IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_network_analytics_tbls_v.rtt_customer_location_cache_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNT(1) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view  WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNTIF(connections IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNTIF(min_fails IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNTIF(all_app_fails IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNTIF(all_app_fails_proj9 IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNTIF(vid_fails IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNTIF(all_app_fails_proj8 IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt AS meas_dt, COUNTIF(imsi IS NULL) AS meas_value, CURRENT_TIMESTAMP() AS load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ran_core_tbls_v.customer_network_capability_summary_daily_norm_view WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(apn_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, count(1) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(message_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(application_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(trackingarea_code IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(rat_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(cell_mcc IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(response_code IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(client_server_entry_type_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(subscriber_ip_address IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(userequipment_model_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(userequipment_manufacturer_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(cell_mnc IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(cell_id IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(application_protocol_type_code IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(device_name IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(response_description IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-i37v-ndldo-0.vzn_ndl_ng1_core_tbls_v.control_plane_raw_v1 WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer, application_name AS market, count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_control_plane_nodal_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2, 3)
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer, application_name AS market, count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_kpi_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2, 3)
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer, application_name AS market, count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_ksi_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2, 3)
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, "NA" market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer, count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_user_plane_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2)
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, "NA" market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer,  count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.lte_metrics_user_plane_nodal_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2)
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, COALESCE(manufacturer, "NA") manufacturer, "NA" market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, call_direction_name AS manufacturer, count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.media_metrics_kpi_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2)
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, COALESCE(manufacturer, "NA") manufacturer, "NA" market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer, count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.metrics_kei_daily_v1 WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2)
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, "NA" market, "NA" technology FROM ( SELECT trans_dt_ct meas_dt, protocol_interface AS manufacturer,  count(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_nwperf_session_ng1_core_tbls_v.volte_metrics_kpi_daily WHERE Cast(trans_dt_ct AS DATE) = "$START_DT" GROUP BY 1, 2)
SELECT trans_dt meas_dt, count(1) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_ebh_core_tbls_v.topn_util_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(mgrs_partition IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwgeo_core_tbls_v.labyrinth_call_drop_mgrs_100_daily_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNT(1) meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwgeo_core_tbls_v.labyrinth_call_drop_mgrs_100_daily_norm WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(mgrs_100m IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwgeo_core_tbls_v.labyrinth_call_drop_mgrs_100_daily_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNT(1) meas_value, current_timestamp load_ts  FROM vz-it-pr-gudv-dtwndo-0.aid_nwgeo_core_tbls_v.labyrinth_rat_changes_mgrs_100_daily_norm WHERE Cast(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(mgrs_100m IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwgeo_core_tbls_v.labyrinth_rat_changes_mgrs_100_daily_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, COUNTIF(mgrs_partition IS NULL) meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_nwgeo_core_tbls_v.labyrinth_rat_changes_mgrs_100_daily_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(inl3_incompletes IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifspeed IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcoutoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcinucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(operating_cpu IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(dhcp_totalleasecount IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(interface_desc IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcinoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifoutucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifoutdiscards IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(operating_memory IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(duration_in_seconds IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifouterrors IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifinucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(operating_buffer IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhspeed IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifinoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifoutoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifinerrors IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(operating_uptime IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifindiscards IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(uptime IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcoutucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, market, "NA" technology FROM ( SELECT trans_dt meas_dt, CAST(timestamp_trunc(event_time, HOUR) AS STRING) manufacturer,  device_name AS market, COUNT(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm  WHERE trans_dt = "$START_DT" GROUP BY 1, 2, 3)
SELECT trans_dt meas_dt, CAST((COUNTIF(dom_currentalarms IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.bng_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifspeed IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcoutoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcinucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifinucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifouterrors IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcinoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(interface_desc IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifindiscards IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifinerrors IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifoutucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(duration_in_seconds IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifinoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifoutdiscards IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhspeed IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifoutoctets IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(uptime IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT trans_dt meas_dt, CAST((COUNTIF(ifhcoutucastpkts IS NULL) / COUNT(1)) * 100 AS INT64)  meas_value, CURRENT_TIMESTAMP() load_ts FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm WHERE CAST(trans_dt AS DATE) = "$START_DT" GROUP BY 1
SELECT meas_dt, COALESCE(meas_value, 0) AS meas_value, current_timestamp load_ts, manufacturer, market, "NA" technology FROM ( SELECT trans_dt meas_dt, CAST(timestamp_trunc(event_time, HOUR) AS STRING) manufacturer,  device_name AS market, COUNT(1) meas_value FROM vz-it-pr-gudv-dtwndo-0.aid_5g_home_ready_tbls_v.dpu_performance_kpi_5min_norm  WHERE trans_dt = "$START_DT" GROUP BY 1, 2, 3)
