select cast(report_month as date) as meas_dt, COUNT(*) as meas_value,current_timestamp load_ts from vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01' group by meas_dt
select meas_dt,sum(report_month_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when REGEXP_CONTAINS(cast(report_month as string),"^[0-9]{4}-[0-9]{2}-[0-9]{2}$") or report_month is not null then 0 else 1 end report_month_pttrn from (select cast(report_month as date) report_month ,cast(report_month as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01') t ) y group by meas_dt
select meas_dt,sum(last_cycle_dt_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when REGEXP_CONTAINS(cast(last_cycle_dt as string),"^[0-9]{4}-[0-9]{2}-[0-9]{2}$") or last_cycle_dt is not null then 0 else 1 end last_cycle_dt_pttrn from (select cast(last_cycle_dt as date) last_cycle_dt ,cast(report_month as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01') t ) y group by meas_dt
select meas_dt,sum(primary_sector_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when safe_cast(primary_sector as INT64) is not null then 0 else 1 end primary_sector_pttrn from (select primary_sector,cast(report_month as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01') t ) y group by meas_dt
select meas_dt,sum(primary_enodeb_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when cast(primary_enodeb as string) is null or primary_enodeb like "[^0-9]" or length(primary_enodeb) != 6 then 1 else 0 end primary_enodeb_pttrn from (select primary_enodeb,cast(report_month as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01') t ) y group by meas_dt
select meas_dt,sum(minutes_of_usage_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when safe_cast(minutes_of_usage as INT64) is not null then 0 else 1 end minutes_of_usage_pttrn,minutes_of_usage from (select minutes_of_usage,cast(process_dt as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01' ) t ) y group by meas_dt
select meas_dt,sum(cycle_end_dt_pttrn) as meas_value,current_timestamp load_ts from (select meas_dt,case when REGEXP_CONTAINS(cast(cycle_end_dt as string),"^[0-9]{4}-[0-9]{2}-[0-9]{2}$") or cycle_end_dt is not null then 0 else 1 end cycle_end_dt_pttrn from (select cast(cycle_end_dt as date) cycle_end_dt ,cast(report_month as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01') t ) y group by meas_dt
select meas_dt,sum(cnt) as meas_value,current_timestamp load_ts from (select count(distinct concat(coalesce(cast(acct_num as string),""),"|",coalesce(cust_id,""),"|",coalesce(cust_line_seq_id,""))) cnt,cast(report_month as date) meas_dt FROM vz-it-pr-gudv-dtwndo-0.aid_dtwin_customer_core_tbls_rd_v.customer_attributes_monthly_norm_v0 where cast(report_month as date) ='2025-03-01' group by acct_num,cust_id,cust_line_seq_id ,cast(report_month as date)) y group by meas_dt


Error:  400 Syntax error: Expected end of input but got keyword SELECT at [5:1]
