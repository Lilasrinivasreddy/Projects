#-----------------------PROCESS META VALIDATION SCRIPT-----------------------
if not process_meta.empty:
    # Drop rows with all empty values
    process_meta.dropna(axis=0, how="all", inplace=True)
    total_process_count = process_meta.shape[0]

    # Replace empty strings with null values
    process_meta = process_meta.infer_objects(copy=False).replace(r'^\s*$', np.nan, regex=True)

    # Remove leading/trailing whitespaces
    process_meta = process_meta.applymap(lambda x: x.strip() if isinstance(x, str) else x)

    # Update variables based on the environment
    if "dev" in env:
        process_meta.replace(dict(zip(variable_list, dev_list)), inplace=True, regex=True)
    elif "test" in env:
        process_meta.replace(variable_list, test_list, inplace=True, regex=True)
    elif "ple" in env:
        process_meta.replace(variable_list, ple_list, inplace=True, regex=True)
    else:
        process_meta.replace(variable_list, prod_list, inplace=True, regex=True)

    process_meta = process_meta.astype("string")

    # Update Data Types for Integer Columns
    for col in process_integer_column:
        process_meta[col] = process_meta[col].replace('', np.nan).fillna('0').astype(int)

    # Update Data Types for Boolean Columns
    for col in process_boolean_column:
        process_meta[col] = process_meta[col].replace('', np.nan).map({'Y': True, 'N': False}).fillna(False)

    # ----------------------------- VALIDATIONS -----------------------------------

    # OBS POC Validation
    obs_poc_cnt = process_meta['obs_poc'].isna().sum()

    # Program Name Validation
    program_name_validation_cnt = process_meta['program_name'].isna().sum()

    # Application Name Validation
    application_name_validation_cnt = process_meta['application_name'].isna().sum() + process_meta.loc[
        process_meta['application_name'].str.strip().str.contains(r'\s', case=False), :].shape[0]

    # Process Name Validation
    process_name_validation_cnt = process_meta['process_name'].isna().sum() + process_meta.loc[
        process_meta['process_name'].str.strip().str.contains(r'\s', case=False), :].shape[0]

    # Subprocess Name Validation
    subprocess_name_validation_cnt = process_meta['subprocess_name'].isna().sum() + process_meta.loc[
        process_meta['subprocess_name'].str.strip().str.contains(r'\s', case=False), :].shape[0]

    # Frequency Validation
    process_meta["frequency"] = process_meta["frequency"].str.lower()
    frequency_validation_cnt = process_meta['frequency'].isna().sum() + (
        total_process_count - process_meta['frequency'].str.strip().str.lower().isin(frequency_list).sum())

    # Is Critical Validation
    process_meta['is_critical'] = process_meta['is_critical'].replace('', "N")
    is_critical_validation_cnt = total_process_count - process_meta['is_critical'].fillna('n').str.lower().isin(flags).sum()

    # Platform Name Validation
    platform_name_validation_cnt = total_process_count - process_meta['platform_name'].fillna('na').str.lower().isin(platform_list).sum()

    # Environment Name Validation
    env_name_validation_cnt = total_process_count - process_meta['env_name'].fillna('na').str.lower().isin(env_list).sum()

    # Process POC Validation (Email Format)
    process_poc_validation_cnt = total_process_count - process_meta.loc[
        process_meta['process_poc'].fillna('na').str.contains(r'[^@]+@[^@]+\.[^@]+', case=False), :].shape[0]

    # Scheduler Name Validation
    scheduler_name_validation_cnt = total_process_count - process_meta['scheduler_name'].fillna('na').str.lower().isin(scheduler_list).sum()

    # Logs Enabled Validation
    logs_enabled_validation_cnt = total_process_count - process_meta['logs_enabled'].str.lower().isin(flags).sum()

    # Mandatory Validation
    process_meta['is_mandatory'] = process_meta['is_mandatory'].replace('', "N")
    is_mandatory_validation_cnt = total_process_count - process_meta['is_mandatory'].fillna('n').str.lower().isin(flags).sum()

    # Business Unit Validation
    businessunit_validation_cnt = total_process_count - process_meta['businessunit'].fillna('n').str.lower().isin(businessunit_list).sum()

    # VSAD Validation
    vsad_validation_cnt = process_meta['vsad'].isna().sum()

    # Timezone Validation
    process_meta["timezone"] = process_meta["timezone"].replace('', "UTC").str.upper()
    timezone_validation_cnt = total_process_count - process_meta['timezone'].isin(time_zone_list).sum()

    # Source and Target Validation
    process_meta_source_filtered = process_meta[process_meta['source'].str.len() != 0]
    source_type_validation_cnt = process_meta_source_filtered.shape[0] - process_meta_source_filtered['source_type'].str.lower().isin(source_type_list).sum()
    process_meta_target_filtered = process_meta[process_meta['target'].str.len() != 0]
    target_type_validation_cnt = process_meta_target_filtered.shape[0] - process_meta_target_filtered['target_type'].str.lower().isin(target_type_list).sum()

    # Run Date Buffer Validation
    process_meta['run_date_buffer_interval'] = process_meta['run_date_buffer_interval'].replace('', "0")
    run_date_buffer_interval_validation_cnt = total_process_count - process_meta.loc[
        process_meta['run_date_buffer_interval'].fillna('0').str.contains(r'[0-9]', case=False), :].shape[0]

    # Collect Volume Validation
    process_meta['collect_volume'] = process_meta['collect_volume'].replace('', "false")
    collect_volume_validation_cnt = total_process_count - process_meta['collect_volume'].fillna('false').str.lower().isin(bool_flag).sum()

    # Duration Threshold Validation
    process_meta['duration_threshold_low_value'] = process_meta['duration_threshold_low_value'].replace('', "20")
    process_meta['duration_threshold_high_value'] = process_meta['duration_threshold_high_value'].replace('', "20")
    duration_threshold_low_value_validation_cnt = total_process_count - process_meta.loc[
        process_meta['duration_threshold_low_value'].fillna('20').str.contains(r'[0-9]', case=False), :].shape[0]
    duration_threshold_high_value_validation_cnt = total_process_count - process_meta.loc[
        process_meta['duration_threshold_high_value'].fillna('20').str.contains(r'[0-9]', case=False), :].shape[0]

    # Additional Info Validation
    process_meta['additional_info'] = process_meta['additional_info'].replace(['NaN', 'nan', ''], np.nan)
    process_meta_additional_info_filtered = process_meta.dropna(subset=['additional_info'])
    additional_info_validation_cnt = process_meta_additional_info_filtered.shape[0] - process_meta_additional_info_filtered.apply(
        lambda x: is_valid_json(x)).sum()

    # ----------------------------- RAISE ERRORS -----------------------------------
    if obs_poc_cnt > 0:
        raise ValueError(f"Missing OBS POC values: {obs_poc_cnt}")
    if program_name_validation_cnt > 0:
        raise ValueError(f"Missing Program Names: {program_name_validation_cnt}")
    if application_name_validation_cnt > 0:
        raise ValueError(f"Invalid Application Names: {application_name_validation_cnt}")
    if process_name_validation_cnt > 0:
        raise ValueError(f"Invalid Process Names: {process_name_validation_cnt}")
    if subprocess_name_validation_cnt > 0:
        raise ValueError(f"Invalid Subprocess Names: {subprocess_name_validation_cnt}")
    if frequency_validation_cnt > 0:
        raise ValueError(f"Invalid Frequency values: {frequency_validation_cnt}")
    if is_critical_validation_cnt > 0:
        raise ValueError(f"Invalid Is Critical values: {is_critical_validation_cnt}")
    if platform_name_validation_cnt > 0:
        raise ValueError(f"Invalid Platform Names: {platform_name_validation_cnt}")
    if env_name_validation_cnt > 0:
        raise ValueError(f"Invalid Environment Names: {env_name_validation_cnt}")
    if process_poc_validation_cnt > 0:
        raise ValueError(f"Invalid Process POC Emails: {process_poc_validation_cnt}")
    if scheduler_name_validation_cnt > 0:
        raise ValueError(f"Invalid Scheduler Names: {scheduler_name_validation_cnt}")
    if logs_enabled_validation_cnt > 0:
        raise ValueError(f"Invalid Logs Enabled values: {logs_enabled_validation_cnt}")
    if is_mandatory_validation_cnt > 0:
        raise ValueError(f"Invalid Is Mandatory values: {is_mandatory_validation_cnt}")
    if businessunit_validation_cnt > 0:
        raise ValueError(f"Invalid Business Unit values: {businessunit_validation_cnt}")
    if vsad_validation_cnt > 0:
        raise ValueError(f"Missing VSAD values: {vsad_validation_cnt}")
    if timezone_validation_cnt > 0:
        raise ValueError(f"Invalid Timezone values: {timezone_validation_cnt}")
    if source_type_validation
