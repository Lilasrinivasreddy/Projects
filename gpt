import re

def fix_query_format(query):
    """
    Wraps schema and table names in double quotes to ensure correct Teradata syntax.
    Example:
    Before: insert into vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt ...
    After:  insert into "vz-it-np-izcv-dev-idmcdo-0"."dga_dq_tbls"."dqaas_profile_rpt" ...
    """
    # ‚úÖ Fix schema.table name formatting
    fixed_query = re.sub(r"(\b[a-zA-Z0-9_-]+\b)\.(\b[a-zA-Z0-9_-]+\b)", r'"\1"." \2"', query)

    # ‚úÖ Remove accidental spaces inside quotes
    fixed_query = re.sub(r'"\s+', '"', fixed_query)  # Remove spaces after opening quote
    fixed_query = re.sub(r'\s+"', '"', fixed_query)  # Remove spaces before closing quote

    print(f"üîç Final Fixed Query Format:\n{fixed_query}\n")
    return fixed_query
