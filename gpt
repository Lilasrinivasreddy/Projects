import re

def fix_query_format(query):
    """
    Properly formats schema and table names for Teradata SQL execution.
    This ensures hyphenated and special character-containing names are wrapped in double quotes.
    """
    # ‚úÖ Correctly format database.schema.table structure
    fixed_query = re.sub(r'(\b[a-zA-Z0-9_-]+\b)\.(\b[a-zA-Z0-9_-]+\b)\.(\b[a-zA-Z0-9_-]+\b)',
                         r'"\1"." \2"." \3"', query)

    # ‚úÖ Remove accidental spaces inside quotes
    fixed_query = re.sub(r'"\s+', '"', fixed_query)  # Remove spaces after opening quote
    fixed_query = re.sub(r'\s+"', '"', fixed_query)  # Remove spaces before closing quote

    print(f"üîç Final Fixed Query Format:\n{fixed_query}\n")
    return fixed_query
