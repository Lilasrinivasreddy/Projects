March 20, 2025 - 20:42:00
Django version 5.1.1, using settings 'dqaas_api.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CTRL-BREAK.

📂 Received FILES: <MultiValueDict: {'file': [<InMemoryUploadedFile: file.txt (text/plain)>]}>
📄 File content:
insert into vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12);
🔍 Fixed Query Format:
insert into "vz-it-np-izcv-dev-idmcdo-0"." dga_dq_tbls"." dqaas_profile_rpt"
(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12)

📌 Executing Fixed Query:
insert into "vz-it-np-izcv-dev-idmcdo-0"." dga_dq_tbls"." dqaas_profile_rpt"
(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12)
🔄 Connecting to Teradata...
✅ Teradata connection successful!
❌ INSERT query execution failed: insert into "vz-it-np-izcv-dev-idmcdo-0"." dga_dq_tbls"." dqaas_profile_rpt"

(rpt_seq_num, prfl_id, prfl_type, dq_pillar, src_tbl, meas_name, data_dt, feature_name, grouped_columns, count_curr, prfl_run_ts, weekday)
(select 900098 as rpt_seq_num, 7851 as prfl_id, 'CUSTOM_RULES' as prfl_type, 'Consistency' as dq_pillar, 'CUST_ACCT_LINE_ADDR_V' as src_tbl,'CUST_ACCT_LINE_ADDR_V Table count' as meas_name,
cast(LAST_UPD_DT as date) as data_dt,'Tier1 Models' as feature_name, null as grouped_columns,count (*) as count_curr, current_timestamp as prfl_run_ts,
dayofweek(cast(LAST_UPD_DT as date)) as weekday from NTL_PRD_ALLVM.CUST_ACCT_LINE_ADDR_V where cast(LAST_UPD_DT as date)>= current_date -90
group by 1,2,3,4,5,6,7,8,11,12)
Error: [Version 20.0.0.15] [Session 243551910] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'TRANSACTIONTIME' keyword or a 'NONTEMPORAL' keyword or 'AS' keyword between the word ' dga_dq_tbls' and '.'.
 at gosqldriver/teradatasql.formatError ErrorUtil.go:91
 at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251
 at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267
 at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715
 at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308
 at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874
 at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720
 at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122
 at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225
 at database/sql.ctxDriverQuery ctxutil.go:48
 at database/sql.(*DB).queryDC.func1 sql.go:1776
 at database/sql.withLock sql.go:3530
 at database/sql.(*DB).queryDC sql.go:1771
 at database/sql.(*Conn).QueryContext sql.go:2027
 at main.createRows goside.go:783
 at main.goCreateRows goside.go:662
 at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389
 at runtime.cgocallbackg1 cgocall.go:420
 at runtime.cgocallbackg cgocall.go:339
 at runtime.cgocallback asm_amd64.s:1079
 at runtime.goexit asm_amd64.s:1695
Internal Server Error: /mle/ExecuteHistorySQL/
2025-03-20 20:42:15,816 - ERROR - Internal Server Error: /mle/ExecuteHistorySQL/
[20/Mar/2025 20:42:15] "POST /mle/ExecuteHistorySQL/ HTTP/1.1" 500 1553



{"status": "failure", "message": "[Version 20.0.0.15] [Session 243554531] [Teradata Database] [Error 3707] Syntax error, expected something like a 'SELECT' keyword or a 'TRANSACTIONTIME' keyword or a 'NONTEMPORAL' keyword or 'AS' keyword between the word ' dga_dq_tbls' and '.'.\n at gosqldriver/teradatasql.formatError ErrorUtil.go:91\n at gosqldriver/teradatasql.(*teradataConnection).formatDatabaseError ErrorUtil.go:251\n at gosqldriver/teradatasql.(*teradataConnection).makeChainedDatabaseError ErrorUtil.go:267\n at gosqldriver/teradatasql.(*teradataConnection).processErrorParcel TeradataConnection.go:715\n at gosqldriver/teradatasql.(*TeradataRows).processResponseBundle TeradataRows.go:2308\n at gosqldriver/teradatasql.(*TeradataRows).executeSQLRequest TeradataRows.go:874\n at gosqldriver/teradatasql.newTeradataRows TeradataRows.go:720\n at gosqldriver/teradatasql.(*teradataStatement).QueryContext TeradataStatement.go:122\n at gosqldriver/teradatasql.(*teradataConnection).QueryContext TeradataConnection.go:1225\n at database/sql.ctxDriverQuery ctxutil.go:48\n at database/sql.(*DB).queryDC.func1 sql.go:1776\n at database/sql.withLock sql.go:3530\n at database/sql.(*DB).queryDC sql.go:1771\n at database/sql.(*Conn).QueryContext sql.go:2027\n at main.createRows goside.go:783\n at main.goCreateRows goside.go:662\n at _cgoexp_97cde1c53cf8_goCreateRows _cgo_gotypes.go:389\n at runtime.cgocallbackg1 cgocall.go:420\n at runtime.cgocallbackg cgocall.go:339\n at runtime.cgocallback asm_amd64.s:1079\n at runtime.goexit asm_amd64.s:1695"}
