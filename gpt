report_df.columns = [col.lower() for col in report_df.columns]  # Ensures lowercase

for idx in report_df.index:
    try:
        table_name = report_df.loc[idx, 'table_name']
        prfl_run_ts = report_df.loc[idx, 'prfl_run_ts']
        jira_assignee = report_df.loc[idx, 'jira_assignee']

        summary = f"LensX | {env} | {data_src} | {data_sub_dmn} | {dq_pillar} | {database_name} | Table: {table_name} | {alert_type}"
        description = f"DQ has failed for Table : {table_name} on Run date : {prfl_run_ts}. DQ status is LOW"

        # Create ticket
        jira_client = Jira_ticket()
        ticket_id = jira_client.create_jira_ticket(jira_assignee, summary, description, "DQaaS")

        self.logger.info(f"Jira Id created: {ticket_id}")

    except Exception as err:
        self.logger.error(f"Error occurred while creating JIRA tickets {err}")
