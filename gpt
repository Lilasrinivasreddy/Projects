# Fetch environment dynamically from the config.ini file and format it as "Dev", "Prod", etc.
environment = self.config.get('environment', 'env').capitalize()

# Generate dynamic email subject for Rule Profile
mail_subject_msg = f"LensX|{environment}|Rule_Profiling_Started|DQ2.0|{ruleprofile.current_date}"
if ruleprofile.monthly_process_yn == "MONTHLY":
    mail_subject_msg = f"LensX|{environment}|Monthly_Rule_Profiling_Started|DQ2.0|{ruleprofile.current_date}"

# Send the email
ruleprofile.email.send_common_message(
    email_template_filepath=ruleprofile.email_template,
    mail_subject=mail_subject_msg,
    message="DQ-2.0 rule profiling has started",
    receipents_email_id=ruleprofile.summary_alert_email_group
)


# Fetch environment dynamically from the config.ini file and format it as "Dev", "Prod", etc.
environment = self.config.get('environment', 'env').capitalize()

# Generate dynamic email subject for Auto Profile
mail_subject_msg = f"LensX|{environment}|Auto_Profiling_Started|DQ2.0|{autoprofile_engine.current_date}"
if autoprofile_engine.monthly_process_yn == "MONTHLY":
    mail_subject_msg = f"LensX|{environment}|Monthly_Auto_Profiling_Started|DQ2.0|{autoprofile_engine.current_date}"

# Send the email
autoprofile_engine.email.send_common_message(
    email_template_filepath=autoprofile_engine.email_template,
    mail_subject=mail_subject_msg,
    message="DQ-2.0 auto profiling has started",
    receipents_email_id=autoprofile_engine.summary_alert_email_group
)


# Fetch environment dynamically from the config.ini file and format it as "Dev", "Prod", etc.
environment = self.config.get('environment', 'env').capitalize()

# Generate dynamic email subject for Custom Profile
mail_subject_msg = f"LensX|{environment}|Custom_Profiling_Started|DQ2.0|{custom_profile_engine.current_date}"
if custom_profile_engine.monthly_process_yn == "MONTHLY":
    mail_subject_msg = f"LensX|{environment}|Monthly_Custom_Profiling_Started|DQ2.0|{custom_profile_engine.current_date}"

# Send the email
custom_profile_engine.email.send_common_message(
    email_template_filepath=custom_profile_engine.email_template,
    mail_subject=mail_subject_msg,
    message="DQ-2.0 custom profiling has started",
    receipents_email_id=custom_profile_engine.summary_alert_email_group
)






--------
# Fetch environment dynamically from the config.ini file and format it as "Dev", "Prod", etc.
environment = self.config.get('environment', 'env').capitalize()

# Generate email subject dynamically for Rule, Auto, and Custom profiles
if schd_type == "DAILY":
    subject = f'{profile_type.capitalize()} Profiling|{environment}|Daily_Summary|DQ2.0|{rule_run_dt}'
elif schd_type == "MONTHLY":
    subject = f'{profile_type.capitalize()} Profiling|{environment}|Monthly_Summary|DQ2.0|{rule_run_dt}'
else:
    subject = f'{profile_type.capitalize()} Profiling|{environment}|Adhoc_Summary|DQ2.0|{rule_run_dt}'

# Send the email
self.email.send_common_message(
    email_template_filepath=self.email_template,
    mail_subject=subject,
    message=message,
    receipents_email_id=self.summary_alert_email_group,
    df_val=df_email_rules_data
)
