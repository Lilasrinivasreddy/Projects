SELECT rule_MTN_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN MTN IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_MTN_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_MTN_DLA_SUM_FACT_V_Completeness;

SELECT rule_SOR_ID_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN SOR_ID IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_SOR_ID_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_SOR_ID_DLA_SUM_FACT_V_Completeness;

SELECT rule_CUST_ID_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN CUST_ID IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_CUST_ID_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_CUST_ID_DLA_SUM_FACT_V_Completeness;

SELECT rule_CUST_LINE_SEQ_ID_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN CUST_LINE_SEQ_ID IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_CUST_LINE_SEQ_ID_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_CUST_LINE_SEQ_ID_DLA_SUM_FACT_V_Completeness;

SELECT rule_ACTIVITY_CD_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN ACTIVITY_CD IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_ACTIVITY_CD_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_ACTIVITY_CD_DLA_SUM_FACT_V_Completeness;

SELECT rule_MTN_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN MTN IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_MTN_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_MTN_DLA_SUM_FACT_V_Completeness;

SELECT rule_ACCT_NUM_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN ACCT_NUM IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_ACCT_NUM_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_ACCT_NUM_DLA_SUM_FACT_V_Completeness;

SELECT rule_CUST_TYPE_CD_DLA_SUM_FACT_V_Completeness, COUNT(*) AS "count"
FROM (
    SELECT CASE 
        WHEN CUST_TYPE_CD IS NOT NULL THEN 'VALID' 
        ELSE 'INVALID' 
    END AS rule_CUST_TYPE_CD_DLA_SUM_FACT_V_Completeness
    FROM NTL_PRD_ALLVM.DLA_FACT_V
    WHERE CAST(ACTIVITY_DATE AS DATE) = CURRENT_DATE - 1
) AS subquery
GROUP BY rule_CUST_TYPE_CD_DLA_SUM_FACT_V_Completeness;
