import pandas as pd

# Ensure date columns are properly formatted
df_report_result['data_dt'] = pd.to_datetime(df_report_result['data_dt'], errors='coerce')
df_report_result['insert_date'] = pd.to_datetime(df_report_result['insert_date'], errors='coerce')
df_report_result['prfl_run_ts'] = pd.to_datetime(df_report_result['prfl_run_ts'], errors='coerce')

# Convert numeric columns
df_report_result['prfl_id'] = pd.to_numeric(df_report_result['prfl_id'], errors='coerce', downcast='integer')
df_report_result['count_curr'] = pd.to_numeric(df_report_result['count_curr'], errors='coerce')
df_report_result['weekday'] = pd.to_numeric(df_report_result['weekday'], errors='coerce', downcast='integer')
df_report_result['rpt_seq_num'] = pd.to_numeric(df_report_result['rpt_seq_num'], errors='coerce', downcast='integer')
df_report_result['dq_score'] = pd.to_numeric(df_report_result['dq_score'], errors='coerce', downcast='integer')

# Convert statistical columns (ensure they are float)
df_report_result['avg_count_prev'] = pd.to_numeric(df_report_result['avg_count_prev'], errors='coerce')
df_report_result['variance_value'] = pd.to_numeric(df_report_result['variance_value'], errors='coerce')
df_report_result['std_dev_value'] = pd.to_numeric(df_report_result['std_dev_value'], errors='coerce')
df_report_result['sigma_2_value'] = pd.to_numeric(df_report_result['sigma_2_value'], errors='coerce')
df_report_result['min_thresh_value'] = pd.to_numeric(df_report_result['min_thresh_value'], errors='coerce')
df_report_result['max_thresh_value'] = pd.to_numeric(df_report_result['max_thresh_value'], errors='coerce')

# Convert categorical columns to string
df_report_result['feature_name'] = df_report_result['feature_name'].astype(str)
df_report_result['grouped_columns'] = df_report_result['grouped_columns'].astype(str)
df_report_result['prfl_type'] = df_report_result['prfl_type'].astype(str)
df_report_result['src_tbl'] = df_report_result['src_tbl'].astype(str)
df_report_result['dq_pillar'] = df_report_result['dq_pillar'].astype(str)
df_report_result['meas_name'] = df_report_result['meas_name'].astype(str)
df_report_result['dq_ind'] = df_report_result['dq_ind'].astype(str)
df_report_result['rpt_ref_key'] = df_report_result['rpt_ref_key'].astype(str)

# Check for missing values and replace with defaults
df_report_result.fillna({'prfl_id': 0, 'count_curr': 0, 'weekday': 0, 'dq_score': 0}, inplace=True)
df_report_result.fillna({'avg_count_prev': 0.0, 'variance_value': 0.0, 'std_dev_value': 0.0, 
                         'sigma_2_value': 0.0, 'min_thresh_value': 0.0, 'max_thresh_value': 0.0}, inplace=True)

# Print the final data types before inserting
print(df_report_result.dtypes)

# Now proceed with loading data into BigQuery
load_result_to_bq_report_table(df_report_result)




(smartdq-venv) tdcldizcva002:/apps/opt/application/smartdq/smartdq_gcp_migration/customer_metrics_and_micro_segment$  python custom_metrics.py
/apps/opt/application/smartdq/smartdq_gcp_migration/customer_metrics_and_micro_segment/../config/config.ini
/apps/opt/application/smartdq/smartdq_gcp_migration/scripts/../config/config.ini
name:CRM-1159420, path:/apps/opt/application/smartdq//smartdq_gcp_migration//logs/2025-03-07/CustomMetricsLogs-2025-03-07-03-29-42.log
2025-03-07 03:29:42 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query:
                SELECT * FROM vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_mtd
                WHERE prfl_type = 'CUSTOM_RULES'
                and IS_ACTIVE_FLG = 'Y'

                ORDER BY PRFL_ID;

2025-03-07 03:29:42 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:29:42 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:29:42 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:29:42 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:29:42 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:29:46 : CRM-1159420 - get_metadata - INFO : Metadata Length: 37
2025-03-07 03:29:46 : CRM-1159420 - main_metrics_execution - INFO :
Request Reference:: 20250307032946198855
Sub Domain:: Tier1_Models
2025-03-07 03:29:46 : CRM-1159420 - run_metrics_engine - INFO : Comparison:: WEEKDAYS, Hourly:: N
0     7662
1     7663
2     7664
3     7666
4     7667
5     7668
6     7669
7     7670
8     7671
9     7672
10    7674
11    7676
12    7678
13    7681
14    7685
15    7686
16    7687
17    7690
18    7695
19    7696
20    7697
21    7699
22    7700
23    7701
24    7702
25    7703
26    7705
27    7708
28    7710
29    7711
30    7712
31    7713
32    7715
33    7716
34    7718
35    7719
36    7721
Name: prfl_id, dtype: Int64
2025-03-07 03:29:46 : CRM-1159420 - run_metrics_engine - INFO : Profile ID List : 7681, 7685, 7686, 7687, 7690, 7695, 7696, 7697, 7699, 7700, 7701, 7702, 7703, 7705, 7708, 7710, 7711, 7712, 7713, 7715, 7716, 7718, 7719, 7721, 7662, 7663, 7664, 7666, 7667, 7668, 7669, 7670, 7671, 7672, 7674, 7676, 7678
2025-03-07 03:29:46 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query:
                select date(current_date-1) as run_dt,
                extract(dayofweek from date(current_date-1)) as weekday;

2025-03-07 03:29:46 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:29:46 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:29:46 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:29:46 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:29:46 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:29:49 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:29:49 : CRM-1159420 - profile_engine - INFO : Index:: 0, Rule ID:: 7662
2025-03-07 03:29:49 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.service where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:29:49 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:29:49 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:29:49 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:29:49 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:29:49 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:29:53 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>       24045 2025-03-07 08:29:50.425709+00:00        5     7662
2025-03-07 03:29:53 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:29:53 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:29:53 : CRM-1159420 - profile_engine - INFO : Index:: 1, Rule ID:: 7663
2025-03-07 03:29:53 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(event_date as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from event_date) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.scm_usage where cast(event_date as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:29:53 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:29:53 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:29:53 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:29:53 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:29:53 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:29:57 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>      300864 2025-03-07 08:29:54.268717+00:00        5     7663
1  2445-03-08  Tier1 Models       <NA>           2 2025-03-07 08:29:54.268717+00:00        4     7663
2  3116-03-01  Tier1 Models       <NA>           1 2025-03-07 08:29:54.268717+00:00        4     7663
3  4016-04-08  Tier1 Models       <NA>           1 2025-03-07 08:29:54.268717+00:00        6     7663
4  4017-08-08  Tier1 Models       <NA>           1 2025-03-07 08:29:54.268717+00:00        3     7663
5  4000-04-24  Tier1 Models       <NA>           2 2025-03-07 08:29:54.268717+00:00        2     7663
6  2025-03-05  Tier1 Models       <NA>      494197 2025-03-07 08:29:54.268717+00:00        4     7663
2025-03-07 03:29:57 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:29:57 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:29:57 : CRM-1159420 - profile_engine - INFO : Index:: 2, Rule ID:: 7664
2025-03-07 03:29:57 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(call_start_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from call_start_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.sa_drivers where cast(call_start_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:29:57 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:29:57 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:29:57 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:29:57 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:29:57 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:01 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>       25556 2025-03-07 08:29:58.399460+00:00        4     7664
2025-03-07 03:30:01 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:01 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:01 : CRM-1159420 - profile_engine - INFO : Index:: 3, Rule ID:: 7666
2025-03-07 03:30:01 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.port_sum_fact where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:01 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:01 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:01 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:01 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:01 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:07 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>       75973 2025-03-07 08:30:02.544066+00:00        5     7666
1  2025-03-05  Tier1 Models       <NA>       27631 2025-03-07 08:30:02.544066+00:00        4     7666
2025-03-07 03:30:07 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:07 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:07 : CRM-1159420 - profile_engine - INFO : Index:: 4, Rule ID:: 7667
2025-03-07 03:30:07 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(pymnt_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from pymnt_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.payment_apo_decline where cast(pymnt_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:07 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:07 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:07 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:07 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:07 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:11 : CRM-1159420 - profile_engine - INFO : No Records Found in Rules
2025-03-07 03:30:11 : CRM-1159420 - profile_engine - INFO : Date Results ::
       run_dt  weekday
0  2025-03-06        5
2025-03-07 03:30:11 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                rule_run_ts  weekday  prfl_id
0  2025-03-06  Tier1 Models        NaN           0 2025-03-07 03:30:11.770464        5     7667
2025-03-07 03:30:11 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:11 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:11 : CRM-1159420 - profile_engine - INFO : Index:: 5, Rule ID:: 7668
2025-03-07 03:30:11 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(pymnt_trans_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from pymnt_trans_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.payment where cast(pymnt_trans_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:11 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:11 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:11 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:11 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:11 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:16 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>     1694284 2025-03-07 08:30:12.559583+00:00        4     7668
2025-03-07 03:30:16 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:16 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:16 : CRM-1159420 - profile_engine - INFO : Index:: 6, Rule ID:: 7669
2025-03-07 03:30:16 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(trans_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from trans_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.mtn_occ_trans where cast(trans_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:16 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:16 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:16 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:16 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:16 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:22 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2030-04-13  Tier1 Models       <NA>           1 2025-03-07 08:30:17.802469+00:00        7     7669
1  2025-03-05  Tier1 Models       <NA>     5119079 2025-03-07 08:30:17.802469+00:00        4     7669
2  2025-03-07  Tier1 Models       <NA>           1 2025-03-07 08:30:17.802469+00:00        6     7669
3  2025-03-06  Tier1 Models       <NA>       12306 2025-03-07 08:30:17.802469+00:00        5     7669
4  2025-07-10  Tier1 Models       <NA>           1 2025-03-07 08:30:17.802469+00:00        5     7669
5  2050-11-02  Tier1 Models       <NA>           1 2025-03-07 08:30:17.802469+00:00        4     7669
2025-03-07 03:30:22 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:22 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:22 : CRM-1159420 - profile_engine - INFO : Index:: 7, Rule ID:: 7670
2025-03-07 03:30:22 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(ivr_call_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from ivr_call_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.ivr_call where cast(ivr_call_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:22 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:22 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:22 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:22 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:22 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:28 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>     1103778 2025-03-07 08:30:24.424624+00:00        4     7670
2025-03-07 03:30:28 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:28 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:28 : CRM-1159420 - profile_engine - INFO : Index:: 8, Rule ID:: 7671
2025-03-07 03:30:28 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.install_loan_trans where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:28 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:28 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:28 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:28 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:28 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:35 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>     4381791 2025-03-07 08:30:29.161195+00:00        4     7671
1  2025-03-06  Tier1 Models       <NA>     2856845 2025-03-07 08:30:29.161195+00:00        5     7671
2025-03-07 03:30:35 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:35 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:35 : CRM-1159420 - profile_engine - INFO : Index:: 9, Rule ID:: 7672
2025-03-07 03:30:35 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.fixed_5g_avail_cust_inquiry where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:35 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:35 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:35 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:35 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:35 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:42 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>    63779119 2025-03-07 08:30:36.039542+00:00        5     7672
2025-03-07 03:30:42 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:42 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:42 : CRM-1159420 - profile_engine - INFO : Index:: 10, Rule ID:: 7674
2025-03-07 03:30:42 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.ecpd_profile where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:42 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:42 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:42 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:42 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:42 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:46 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>     8510181 2025-03-07 08:30:43.262748+00:00        5     7674
2025-03-07 03:30:46 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:46 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:46 : CRM-1159420 - profile_engine - INFO : Index:: 11, Rule ID:: 7676
2025-03-07 03:30:46 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.dly_service_activity where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:46 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:46 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:46 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:46 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:46 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:30:56 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>     6688205 2025-03-07 08:30:47.815800+00:00        5     7676
1  2025-03-05  Tier1 Models       <NA>     7279712 2025-03-07 08:30:47.815800+00:00        4     7676
2025-03-07 03:30:56 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:56 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:30:56 : CRM-1159420 - profile_engine - INFO : Index:: 12, Rule ID:: 7678
2025-03-07 03:30:56 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.dly_line_activity_pending where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:30:56 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:30:56 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:30:56 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:30:56 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:30:56 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:02 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>       70396 2025-03-07 08:30:57.454119+00:00        5     7678
1  2025-03-05  Tier1 Models       <NA>       54539 2025-03-07 08:30:57.454119+00:00        4     7678
2025-03-07 03:31:02 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:02 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:02 : CRM-1159420 - profile_engine - INFO : Index:: 13, Rule ID:: 7681
2025-03-07 03:31:02 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(fcst_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from fcst_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.discos_fcst_js where cast(fcst_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:02 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:02 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:02 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:02 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:02 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:06 : CRM-1159420 - profile_engine - INFO :
        data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0    2025-04-15  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        3     7681
1    2025-05-11  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        1     7681
2    2025-04-27  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        1     7681
3    2025-05-04  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        1     7681
4    2025-04-06  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        1     7681
..          ...           ...        ...         ...                              ...      ...      ...
113  2025-03-09  Tier1 Models       <NA>       58020 2025-03-07 08:31:03.005225+00:00        1     7681
114  2025-04-14  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        2     7681
115  2025-05-20  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        3     7681
116  2025-06-14  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        7     7681
117  2025-06-13  Tier1 Models       <NA>       30756 2025-03-07 08:31:03.005225+00:00        6     7681

[118 rows x 7 columns]
2025-03-07 03:31:06 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:06 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:06 : CRM-1159420 - profile_engine - INFO : Index:: 14, Rule ID:: 7685
2025-03-07 03:31:06 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_svc_prod_trans where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:06 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:06 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:06 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:06 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:06 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:12 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>       90235 2025-03-07 08:31:07.262131+00:00        5     7685
1  2025-03-05  Tier1 Models       <NA>       97148 2025-03-07 08:31:07.262131+00:00        4     7685
2025-03-07 03:31:12 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:12 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:12 : CRM-1159420 - profile_engine - INFO : Index:: 15, Rule ID:: 7686
2025-03-07 03:31:12 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_promo_activity where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:12 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:12 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:12 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:12 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:12 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:18 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>        1229 2025-03-07 08:31:12.922316+00:00        4     7686
1  2025-03-07  Tier1 Models       <NA>        1091 2025-03-07 08:31:12.922316+00:00        6     7686
2  2025-03-06  Tier1 Models       <NA>        1333 2025-03-07 08:31:12.922316+00:00        5     7686
2025-03-07 03:31:18 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:18 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:18 : CRM-1159420 - profile_engine - INFO : Index:: 16, Rule ID:: 7687
2025-03-07 03:31:18 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_occ_trans where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:18 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:18 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:18 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:18 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:18 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:24 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>      794852 2025-03-07 08:31:18.971979+00:00        4     7687
2025-03-07 03:31:24 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:24 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:24 : CRM-1159420 - profile_engine - INFO : Index:: 17, Rule ID:: 7690
2025-03-07 03:31:24 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_svc_prod_tran where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:24 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:24 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:24 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:24 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:24 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:36 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>  2015194499 2025-03-07 08:31:24.932999+00:00        5     7690
2025-03-07 03:31:36 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:36 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:36 : CRM-1159420 - profile_engine - INFO : Index:: 18, Rule ID:: 7695
2025-03-07 03:31:36 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_reg where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:36 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:36 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:36 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:36 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:36 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:41 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>     6451617 2025-03-07 08:31:37.481444+00:00        5     7695
1  2025-03-05  Tier1 Models       <NA>     1430659 2025-03-07 08:31:37.481444+00:00        4     7695
2025-03-07 03:31:41 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:41 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:41 : CRM-1159420 - profile_engine - INFO : Index:: 19, Rule ID:: 7696
2025-03-07 03:31:41 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_promo where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:41 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:41 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:41 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:41 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:41 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:49 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>      151848 2025-03-07 08:31:42.555723+00:00        5     7696
1  2025-03-05  Tier1 Models       <NA>      742778 2025-03-07 08:31:42.555723+00:00        4     7696
2025-03-07 03:31:49 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:49 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:49 : CRM-1159420 - profile_engine - INFO : Index:: 20, Rule ID:: 7697
2025-03-07 03:31:49 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_pplan_hist where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:49 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:49 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:49 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:49 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:49 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:31:55 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>      458977 2025-03-07 08:31:50.150593+00:00        4     7697
1  2025-03-06  Tier1 Models       <NA>      447283 2025-03-07 08:31:50.150593+00:00        5     7697
2025-03-07 03:31:55 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:55 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:31:55 : CRM-1159420 - profile_engine - INFO : Index:: 21, Rule ID:: 7699
2025-03-07 03:31:55 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_pplan where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:31:55 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:31:55 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:31:55 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:31:55 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:31:55 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:01 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>      283793 2025-03-07 08:31:56.059321+00:00        4     7699
1  2025-03-06  Tier1 Models       <NA>     1681930 2025-03-07 08:31:56.059321+00:00        5     7699
2025-03-07 03:32:01 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:01 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:01 : CRM-1159420 - profile_engine - INFO : Index:: 22, Rule ID:: 7700
2025-03-07 03:32:01 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_email where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:01 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:01 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:01 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:01 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:01 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:07 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>       79786 2025-03-07 08:32:02.413732+00:00        5     7700
1  2025-03-05  Tier1 Models       <NA>       92819 2025-03-07 08:32:02.413732+00:00        4     7700
2025-03-07 03:32:07 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:07 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:07 : CRM-1159420 - profile_engine - INFO : Index:: 23, Rule ID:: 7701
2025-03-07 03:32:07 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_dly_hist where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:07 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:07 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:07 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:07 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:07 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:13 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>     1070953 2025-03-07 08:32:08.414511+00:00        5     7701
1  2025-03-05  Tier1 Models       <NA>     1240742 2025-03-07 08:32:08.414511+00:00        4     7701
2025-03-07 03:32:13 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:13 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:13 : CRM-1159420 - profile_engine - INFO : Index:: 24, Rule ID:: 7702
2025-03-07 03:32:13 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_dim_dly_hist where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:13 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:13 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:13 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:13 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:13 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:18 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>      158425 2025-03-07 08:32:14.202265+00:00        5     7702
1  2025-03-05  Tier1 Models       <NA>      164558 2025-03-07 08:32:14.202265+00:00        4     7702
2025-03-07 03:32:18 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:18 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:18 : CRM-1159420 - profile_engine - INFO : Index:: 25, Rule ID:: 7703
2025-03-07 03:32:18 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(insert_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from insert_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_cloud_usg where cast(insert_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:18 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:18 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:18 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:18 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:18 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:24 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>    38288704 2025-03-07 08:32:19.840958+00:00        5     7703
2025-03-07 03:32:24 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:24 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:24 : CRM-1159420 - profile_engine - INFO : Index:: 26, Rule ID:: 7705
2025-03-07 03:32:24 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:24 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:24 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:24 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:24 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:24 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:28 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>      832111 2025-03-07 08:32:25.468049+00:00        4     7705
1  2025-03-06  Tier1 Models       <NA>    10233912 2025-03-07 08:32:25.468049+00:00        5     7705
2025-03-07 03:32:28 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:28 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:28 : CRM-1159420 - profile_engine - INFO : Index:: 27, Rule ID:: 7708
2025-03-07 03:32:28 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_dly_hist where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:28 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:28 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:28 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:28 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:28 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:33 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>     1077500 2025-03-07 08:32:29.761573+00:00        4     7708
1  2025-03-06  Tier1 Models       <NA>      837678 2025-03-07 08:32:29.761573+00:00        5     7708
2025-03-07 03:32:33 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:33 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:33 : CRM-1159420 - profile_engine - INFO : Index:: 28, Rule ID:: 7710
2025-03-07 03:32:33 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_addr_dly_hist where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:33 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:33 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:33 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:33 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:33 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:39 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>      536526 2025-03-07 08:32:34.809190+00:00        4     7710
1  2025-03-06  Tier1 Models       <NA>       91137 2025-03-07 08:32:34.809190+00:00        5     7710
2025-03-07 03:32:39 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:39 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:39 : CRM-1159420 - profile_engine - INFO : Index:: 29, Rule ID:: 7711
2025-03-07 03:32:39 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_addr where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:39 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:39 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:39 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:39 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:39 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:44 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>       71717 2025-03-07 08:32:40.106403+00:00        5     7711
1  2025-03-05  Tier1 Models       <NA>      292474 2025-03-07 08:32:40.106403+00:00        4     7711
2025-03-07 03:32:44 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:44 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:44 : CRM-1159420 - profile_engine - INFO : Index:: 30, Rule ID:: 7712
2025-03-07 03:32:44 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:44 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:44 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:44 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:44 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:44 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:49 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-06  Tier1 Models       <NA>     1114500 2025-03-07 08:32:45.036982+00:00        5     7712
1  2025-03-05  Tier1 Models       <NA>    11886449 2025-03-07 08:32:45.036982+00:00        4     7712
2025-03-07 03:32:49 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:49 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:49 : CRM-1159420 - profile_engine - INFO : Index:: 31, Rule ID:: 7713
2025-03-07 03:32:49 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(LAST_UPD_DT as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from LAST_UPD_DT) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cjcm_case_hist where cast(LAST_UPD_DT as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:49 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:49 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:49 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:49 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:49 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:54 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>     1073935 2025-03-07 08:32:50.151397+00:00        4     7713
1  2025-03-06  Tier1 Models       <NA>     1086619 2025-03-07 08:32:50.151397+00:00        5     7713
2025-03-07 03:32:54 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:54 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:54 : CRM-1159420 - profile_engine - INFO : Index:: 32, Rule ID:: 7715
2025-03-07 03:32:54 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(call_start_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from call_start_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.calls_driver_trans where cast(call_start_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:54 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:54 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:54 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:54 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:54 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:32:58 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>        9813 2025-03-07 08:32:55.296790+00:00        4     7715
2025-03-07 03:32:58 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:58 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:32:58 : CRM-1159420 - profile_engine - INFO : Index:: 33, Rule ID:: 7716
2025-03-07 03:32:58 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(last_upd_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from last_upd_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cacs_cust_acct_coll where cast(last_upd_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:32:58 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:32:58 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:32:58 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:32:58 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:32:58 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:33:03 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>      214813 2025-03-07 08:32:59.533227+00:00        4     7716
1  2025-03-06  Tier1 Models       <NA>     3162096 2025-03-07 08:32:59.533227+00:00        5     7716
2025-03-07 03:33:03 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:03 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:03 : CRM-1159420 - profile_engine - INFO : Index:: 34, Rule ID:: 7718
2025-03-07 03:33:03 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(current_date as date)as profile_date,
'Tier1 models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from current_date) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.acss_dept group by 1,2,3,5,6
2025-03-07 03:33:03 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:33:03 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:33:03 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:33:03 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:33:03 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:33:07 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-07  Tier1 models       <NA>         870 2025-03-07 08:33:04.670543+00:00        6     7718
2025-03-07 03:33:07 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:07 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:07 : CRM-1159420 - profile_engine - INFO : Index:: 35, Rule ID:: 7719
2025-03-07 03:33:07 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(acss_call_dt as date)as profile_date,
'Tier1 Models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from acss_call_dt) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.acss_call where cast(acss_call_dt as date)>= current_date -2 group by 1,2,3,5,6
2025-03-07 03:33:07 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:33:07 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:33:07 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:33:07 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:33:07 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:33:12 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-05  Tier1 Models       <NA>      537923 2025-03-07 08:33:08.380265+00:00        4     7719
2025-03-07 03:33:12 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:12 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:12 : CRM-1159420 - profile_engine - INFO : Index:: 36, Rule ID:: 7721
2025-03-07 03:33:12 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query: select cast(current_date as date)as profile_date,
'Tier1 models' as feature_name,
null as dimension,
count (*) as value,
current_timestamp as insert_date,
extract(dayofweek from current_date) as weekday
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_dmtbls_rd_v.dma_line_add group by 1,2,3,5,6
2025-03-07 03:33:12 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:33:12 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:33:12 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:33:12 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:33:12 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:33:47 : CRM-1159420 - profile_engine - INFO :
      data_dt  feature_name  dimension  count_curr                      insert_date  weekday  prfl_id
0  2025-03-07  Tier1 models       <NA>   714082827 2025-03-07 08:33:13.574198+00:00        6     7721
2025-03-07 03:33:47 : CRM-1159420 - profile_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:47 : CRM-1159420 - profile_engine - INFO : Length of the Rules Result : 186
2025-03-07 03:33:47 : CRM-1159420 - profile_engine - INFO :
Index(['data_dt', 'feature_name', 'dimension', 'count_curr', 'insert_date',
       'weekday', 'prfl_id', 'rule_run_ts'],
      dtype='object')
      data_dt  feature_name dimension  count_curr                      insert_date  weekday  prfl_id rule_run_ts
0  2025-03-06  Tier1 Models      <NA>       24045 2025-03-07 08:29:50.425709+00:00        5     7662         NaT
1  2025-03-06  Tier1 Models      <NA>      300864 2025-03-07 08:29:54.268717+00:00        5     7663         NaT
2  2445-03-08  Tier1 Models      <NA>           2 2025-03-07 08:29:54.268717+00:00        4     7663         NaT
3  3116-03-01  Tier1 Models      <NA>           1 2025-03-07 08:29:54.268717+00:00        4     7663         NaT
4  4016-04-08  Tier1 Models      <NA>           1 2025-03-07 08:29:54.268717+00:00        6     7663         NaT
2025-03-07 03:33:47 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query:
            with top_records as
            (
            select *,row_number() over (partition by prfl_id,feature_name,grouped_columns order by data_dt desc) as row_num
            from vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt join
            unnest(GENERATE_DATE_ARRAY(date_sub(current_date-1,INTERVAL 3 MONTH),current_date-1, INTERVAL 1 day)) as interval_Date
            on data_dt = interval_Date
            where prfl_id IN (7681, 7685, 7686, 7687, 7690, 7695, 7696, 7697, 7699, 7700, 7701, 7702, 7703, 7705, 7708, 7710, 7711, 7712, 7713, 7715, 7716, 7718, 7719, 7721, 7662, 7663, 7664, 7666, 7667, 7668, 7669, 7670, 7671, 7672, 7674, 7676, 7678)
            and data_dt != current_date-1
            order by prfl_id,feature_name, grouped_columns,data_dt desc
            )
            select prfl_id,feature_name,grouped_columns,WEEKDAY,
            round(sum(ifnull(count_curr, 0)), 2) as sum_count_prev,
            round(avg(ifnull(count_curr, 0)), 2) as avg_count_prev,
            round(var_pop(ifnull(count_curr, 0)), 2) as variance_value,
            round(stddev_pop(ifnull(count_curr, 0)), 2) as std_dev_value,
            round(stddev_pop(ifnull(count_curr, 0)) * 2.0, 2) as sigma_2_value,
            round(avg(ifnull(count_curr, 0)) - stddev_pop(ifnull(count_curr, 0)) * 2.0, 2) as min_thresh_value,
            round(avg(ifnull(count_curr, 0)) + stddev_pop(ifnull(count_curr, 0)) * 2.0, 2) as max_thresh_value
            from top_records
            group by prfl_id,feature_name,grouped_columns,WEEKDAY
            order by prfl_id,feature_name,grouped_columns,WEEKDAY;

2025-03-07 03:33:47 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:33:47 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:33:47 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:33:47 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:33:47 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:33:51 : CRM-1159420 - get_historical_details - INFO : Length of the historical groupby list : 0
2025-03-07 03:33:51 : CRM-1159420 - get_historical_details - INFO :
Index(['prfl_id', 'feature_name', 'grouped_columns', 'weekday',
       'sum_count_prev', 'avg_count_prev', 'variance_value', 'std_dev_value',
       'sigma_2_value', 'min_thresh_value', 'max_thresh_value'],
      dtype='object')
Empty DataFrame
Columns: [prfl_id, feature_name, grouped_columns, weekday, sum_count_prev, avg_count_prev, variance_value, std_dev_value, sigma_2_value, min_thresh_value, max_thresh_value]
Index: []
2025-03-07 03:33:51 : CRM-1159420 - get_historical_details - WARNING : Historical Data Not found for Identifying the variance
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : ------------------------------------------------------------------
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Historical Dtypes before conversion:
prfl_id             object
feature_name        object
grouped_columns     object
weekday             object
sum_count_prev      object
avg_count_prev      object
variance_value      object
std_dev_value       object
sigma_2_value       object
min_thresh_value    object
max_thresh_value    object
dtype: object
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Latest Dtypes before conversion:
data_dt                         object
feature_name                    object
grouped_columns                 object
count_curr                       int64
insert_date        datetime64[ns, UTC]
weekday                          int64
prfl_id                          int64
prfl_run_ts                     object
dtype: object
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Converting column count_curr in df_tbl_latest_rec from Int64Dtype to int64
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Converting column weekday in df_tbl_latest_rec from Int64Dtype to int64
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Converting column prfl_id in df_tbl_latest_rec from Int64Dtype to int64
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Historical Data Types AFTER conversion:
prfl_id             object
feature_name        object
grouped_columns     object
weekday             object
sum_count_prev      object
avg_count_prev      object
variance_value      object
std_dev_value       object
sigma_2_value       object
min_thresh_value    object
max_thresh_value    object
dtype: object
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Latest Data Types AFTER conversion:
data_dt                         object
feature_name                    object
grouped_columns                 object
count_curr                       int64
insert_date        datetime64[ns, UTC]
weekday                          int64
prfl_id                          int64
prfl_run_ts                     object
dtype: object
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Length of the historical Records : 0
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO :
Index(['prfl_id', 'feature_name', 'grouped_columns', 'weekday',
       'sum_count_prev', 'avg_count_prev', 'variance_value', 'std_dev_value',
       'sigma_2_value', 'min_thresh_value', 'max_thresh_value'],
      dtype='object')
Empty DataFrame
Columns: [prfl_id, feature_name, grouped_columns, weekday, sum_count_prev, avg_count_prev, variance_value, std_dev_value, sigma_2_value, min_thresh_value, max_thresh_value]
Index: []
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : ------------------------------------------------------------------
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Length of the latest Records : 186
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO :
Index(['data_dt', 'feature_name', 'grouped_columns', 'count_curr',
       'insert_date', 'weekday', 'prfl_id', 'prfl_run_ts'],
      dtype='object')
      data_dt  feature_name  grouped_columns  count_curr                      insert_date  weekday  prfl_id          prfl_run_ts
0  2025-03-06  Tier1 Models              NaN       24045 2025-03-07 08:29:50.425709+00:00        5     7662  2025-03-07 03:33:47
1  2025-03-06  Tier1 Models              NaN      300864 2025-03-07 08:29:54.268717+00:00        5     7663  2025-03-07 03:33:47
2  2445-03-08  Tier1 Models              NaN           2 2025-03-07 08:29:54.268717+00:00        4     7663  2025-03-07 03:33:47
3  3116-03-01  Tier1 Models              NaN           1 2025-03-07 08:29:54.268717+00:00        4     7663  2025-03-07 03:33:47
4  4016-04-08  Tier1 Models              NaN           1 2025-03-07 08:29:54.268717+00:00        6     7663  2025-03-07 03:33:47
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Columns in df_tbl_hist_rec: Index(['prfl_id', 'feature_name', 'grouped_columns', 'weekday',
       'sum_count_prev', 'avg_count_prev', 'variance_value', 'std_dev_value',
       'sigma_2_value', 'min_thresh_value', 'max_thresh_value'],
      dtype='object')
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Columns in df_tbl_latest_rec: Index(['data_dt', 'feature_name', 'grouped_columns', 'count_curr',
       'insert_date', 'weekday', 'prfl_id', 'prfl_run_ts'],
      dtype='object')
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : ------------------------------------------------------------------
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : Length of the Merged Records : 186
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO :
Index(['sum_count_prev', 'avg_count_prev', 'variance_value', 'std_dev_value',
       'sigma_2_value', 'min_thresh_value', 'max_thresh_value', 'data_dt',
       'feature_name', 'grouped_columns', 'count_curr', 'insert_date',
       'weekday', 'prfl_id', 'prfl_run_ts'],
      dtype='object')
  sum_count_prev avg_count_prev variance_value std_dev_value  ...                      insert_date weekday prfl_id          prfl_run_ts
0            NaN            NaN            NaN           NaN  ... 2025-03-07 08:29:50.425709+00:00       5    7662  2025-03-07 03:33:47
1            NaN            NaN            NaN           NaN  ... 2025-03-07 08:29:54.268717+00:00       5    7663  2025-03-07 03:33:47
2            NaN            NaN            NaN           NaN  ... 2025-03-07 08:29:54.268717+00:00       4    7663  2025-03-07 03:33:47
3            NaN            NaN            NaN           NaN  ... 2025-03-07 08:29:54.268717+00:00       4    7663  2025-03-07 03:33:47
4            NaN            NaN            NaN           NaN  ... 2025-03-07 08:29:54.268717+00:00       6    7663  2025-03-07 03:33:47

[5 rows x 15 columns]
2025-03-07 03:33:51 : CRM-1159420 - compare_historical_latest_dimensions - INFO : ------------------------------------------------------------------
calculate_percentage_change
calculate_sigma_value
calculate_dq_status
2025-03-07 03:33:51 : CRM-1159420 - run_metrics_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:51 : CRM-1159420 - run_metrics_engine - INFO : Length of the End Results : 186
2025-03-07 03:33:51 : CRM-1159420 - run_metrics_engine - INFO :
Index(['sum_count_prev', 'avg_count_prev', 'variance_value', 'std_dev_value',
       'sigma_2_value', 'min_thresh_value', 'max_thresh_value', 'data_dt',
       'feature_name', 'grouped_columns', 'count_curr', 'insert_date',
       'weekday', 'prfl_id', 'prfl_run_ts', 'prfl_type', 'src_tbl',
       'dq_pillar', 'meas_name', 'min_threshold', 'max_threshold',
       'comparison_type', 'is_hourly_flg', 'pct_change', 'consistency_score',
       'dq_score', 'sigma_value', 'dq_ind'],
      dtype='object')
  sum_count_prev  avg_count_prev variance_value  std_dev_value sigma_2_value  ...  pct_change  consistency_score dq_score sigma_value dq_ind
0            NaN             NaN            NaN            NaN           NaN  ...         NaN                0.0        0     outlier    LOW
1            NaN             NaN            NaN            NaN           NaN  ...         NaN                0.0        0     outlier    LOW
2            NaN             NaN            NaN            NaN           NaN  ...         NaN                0.0        0     outlier    LOW
3            NaN             NaN            NaN            NaN           NaN  ...         NaN                0.0        0     outlier    LOW
4            NaN             NaN            NaN            NaN           NaN  ...         NaN                0.0        0     outlier    LOW

[5 rows x 28 columns]
2025-03-07 03:33:51 : CRM-1159420 - run_metrics_engine - INFO : ------------------------------------------------------------------
2025-03-07 03:33:51 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:33:51 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:33:51 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:33:51 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:33:51 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:33:51 : CRM-1159420 - load_to_report_results - INFO : Converting column weekday from Int64Dtype to int64
2025-03-07 03:33:51 : CRM-1159420 - load_to_report_results - INFO : Converting column prfl_id from Int64Dtype to int64
2025-03-07 03:33:51 : CRM-1159420 - load_to_report_results - INFO : Converting column dq_score from Int64Dtype to int64
2025-03-07 03:33:51 : CRM-1159420 - load_result_to_bq_report_table - INFO :
            ======================================================================================
            Load Result Started for Table : vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
            Sequence Column: rpt_seq_num
            Records Length: 186
            Report Columns: Index(['sum_count_prev', 'avg_count_prev', 'variance_value', 'std_dev_value',
       'sigma_2_value', 'min_thresh_value', 'max_thresh_value', 'data_dt',
       'feature_name', 'grouped_columns', 'count_curr', 'insert_date',
       'weekday', 'prfl_id', 'prfl_run_ts', 'prfl_type', 'src_tbl',
       'dq_pillar', 'meas_name', 'min_threshold', 'max_threshold',
       'comparison_type', 'is_hourly_flg', 'pct_change', 'consistency_score',
       'dq_score', 'sigma_value', 'dq_ind', 'rpt_ref_key'],
      dtype='object')
            ======================================================================================

2025-03-07 03:33:51 : CRM-1159420 - get_bq_max_sequence - INFO : sq_column: rpt_seq_num
 bq_tablename : vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
2025-03-07 03:33:51 : CRM-1159420 - get_bq_max_sequence - INFO : BQ query: select IFNULL(MAX(rpt_seq_num), 0) from vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
2025-03-07 03:33:54 : CRM-1159420 - get_bq_max_sequence - INFO : count:        f0_
0  8927101
2025-03-07 03:33:54 : CRM-1159420 - get_bq_max_sequence - INFO : Max Sequence: 8927101
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO :
            Dataframe Columns:['sum_count_prev', 'avg_count_prev', 'variance_value', 'std_dev_value', 'sigma_2_value', 'min_thresh_value', 'max_thresh_value', 'data_dt', 'feature_name', 'grouped_columns', 'count_curr', 'insert_date', 'weekday', 'prfl_id', 'prfl_run_ts', 'prfl_type', 'src_tbl', 'dq_pillar', 'meas_name', 'min_threshold', 'max_threshold', 'comparison_type', 'is_hourly_flg', 'pct_change', 'consistency_score', 'dq_score', 'sigma_value', 'dq_ind', 'rpt_ref_key', 'rpt_seq_num']
            Requried Columns: ['avg_count_prev', 'variance_value', 'std_dev_value', 'pct_change', 'count_curr', 'sigma_2_value', 'dq_score', 'consistency_score', 'prfl_id', 'weekday', 'rpt_seq_num', 'feature_name', 'grouped_columns', 'sigma_value', 'rpt_ref_key', 'data_dt', 'prfl_type', 'src_tbl', 'dq_pillar', 'meas_name', 'dq_ind', 'prfl_run_ts']

2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : Columns for : ['avg_count_prev', 'variance_value', 'std_dev_value', 'pct_change', 'count_curr', 'sigma_2_value', 'dq_score', 'consistency_score', 'prfl_id', 'weekday', 'rpt_seq_num', 'feature_name', 'grouped_columns', 'sigma_value', 'rpt_ref_key', 'data_dt', 'prfl_type', 'src_tbl', 'dq_pillar', 'meas_name', 'dq_ind', 'prfl_run_ts']
<class 'pandas.core.frame.DataFrame'>
Int64Index: 186 entries, 0 to 185
Data columns (total 22 columns):
 #   Column             Non-Null Count  Dtype
---  ------             --------------  -----
 0   avg_count_prev     0 non-null      float64
 1   variance_value     0 non-null      object
 2   std_dev_value      0 non-null      float64
 3   sigma_2_value      0 non-null      object
 4   data_dt            186 non-null    object
 5   feature_name       186 non-null    object
 6   grouped_columns    186 non-null    object
 7   count_curr         186 non-null    float64
 8   weekday            186 non-null    int64
 9   prfl_id            186 non-null    int64
 10  prfl_run_ts        186 non-null    object
 11  prfl_type          186 non-null    object
 12  src_tbl            186 non-null    object
 13  dq_pillar          186 non-null    object
 14  meas_name          186 non-null    object
 15  pct_change         1 non-null      float64
 16  consistency_score  186 non-null    float64
 17  dq_score           186 non-null    int64
 18  sigma_value        186 non-null    object
 19  dq_ind             186 non-null    object
 20  rpt_ref_key        186 non-null    object
 21  rpt_seq_num        186 non-null    int64
dtypes: float64(5), int64(4), object(13)
memory usage: 33.4+ KB
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : None
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : String.................
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : Numeric................
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : Integer................
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : Datetime...............
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : TIMESTAMP...............
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : Completed..............
<class 'pandas.core.frame.DataFrame'>
Int64Index: 186 entries, 0 to 185
Data columns (total 22 columns):
 #   Column             Non-Null Count  Dtype
---  ------             --------------  -----
 0   avg_count_prev     0 non-null      object
 1   variance_value     0 non-null      object
 2   std_dev_value      0 non-null      object
 3   sigma_2_value      0 non-null      object
 4   data_dt            186 non-null    object
 5   feature_name       186 non-null    object
 6   grouped_columns    186 non-null    object
 7   count_curr         186 non-null    object
 8   weekday            186 non-null    int64
 9   prfl_id            186 non-null    int64
 10  prfl_run_ts        186 non-null    datetime64[ns]
 11  prfl_type          186 non-null    object
 12  src_tbl            186 non-null    object
 13  dq_pillar          186 non-null    object
 14  meas_name          186 non-null    object
 15  pct_change         1 non-null      object
 16  consistency_score  186 non-null    object
 17  dq_score           186 non-null    object
 18  sigma_value        186 non-null    object
 19  dq_ind             186 non-null    object
 20  rpt_ref_key        186 non-null    object
 21  rpt_seq_num        186 non-null    int64
dtypes: datetime64[ns](1), int64(3), object(18)
memory usage: 33.4+ KB
2025-03-07 03:33:54 : CRM-1159420 - load_result_to_bq_report_table - INFO : None
2025-03-07 03:33:55 : CRM-1159420 - load_result_to_bq_report_table - ERROR : Error Occurred while loading Results to BigQuery Table. Error: object of type <class 'str'> cannot be converted to int
2025-03-07 03:33:55 : CRM-1159420 - load_result_to_bq_report_table - INFO : Load Result Error vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt table
2025-03-07 03:33:55 : CRM-1159420 - load_to_report_results - INFO : df_report_result dtypes:
sum_count_prev                    object
avg_count_prev                   float64
variance_value                    object
std_dev_value                    float64
sigma_2_value                     object
min_thresh_value                 float64
max_thresh_value                 float64
data_dt                           object
feature_name                      object
grouped_columns                   object
count_curr                       float64
insert_date          datetime64[ns, UTC]
weekday                            int64
prfl_id                            int64
prfl_run_ts                       object
prfl_type                         object
src_tbl                           object
dq_pillar                         object
meas_name                         object
min_threshold                    float64
max_threshold                    float64
comparison_type                   object
is_hourly_flg                     object
pct_change                       float64
consistency_score                float64
dq_score                           int64
sigma_value                       object
dq_ind                            object
rpt_ref_key                       object
dtype: object
2025-03-07 03:33:55 : CRM-1159420 - send_email_report - INFO : Mail Query :
                select rpt.*,
                mtd.data_lob, mtd.data_bus_elem ,mtd.db_name ,mtd.src_tbl ,mtd.dq_pillar
                from vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_mtd mtd
                inner join
                (select * from vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
                where rpt_ref_key = '20250307032946198855' ) rpt
                on mtd.prfl_id = rpt.prfl_id
                and upper(mtd.prfl_type) = 'CUSTOM_RULES'

2025-03-07 03:33:55 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query:
                select rpt.*,
                mtd.data_lob, mtd.data_bus_elem ,mtd.db_name ,mtd.src_tbl ,mtd.dq_pillar
                from vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_mtd mtd
                inner join
                (select * from vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
                where rpt_ref_key = '20250307032946198855' ) rpt
                on mtd.prfl_id = rpt.prfl_id
                and upper(mtd.prfl_type) = 'CUSTOM_RULES'

2025-03-07 03:33:55 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:33:55 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:33:55 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:33:55 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:33:55 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:33:58 : CRM-1159420 - send_email_report - ERROR : Error in Report Summary Email Block. Error:No Records found for Email Summary
2025-03-07 03:33:58 : CRM-1159420 - send_opsgenie_jira_outlier_alert - INFO : Opsgenie Info Query:
                SELECT rpt.*,
                    mtd.data_lob, mtd.data_dmn,mtd.data_sub_dmn, mtd.db_name, mtd.src_tbl,mtd.meas_name,
                    mtd.data_src, mtd.dq_pillar, mtd.opsgenie_api_key, mtd.is_opsgenie_flg,mtd.jira_assignee
                FROM vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_mtd mtd
                INNER JOIN
                (SELECT * FROM vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
                WHERE rpt_ref_key = '20250307032946198855') rpt
                ON mtd.prfl_id = rpt.prfl_id
                WHERE upper(mtd.prfl_type) = 'CUSTOM_RULES'

2025-03-07 03:33:58 : CRM-1159420 - run_bq_sql - INFO :
BQ Select Query:
                SELECT rpt.*,
                    mtd.data_lob, mtd.data_dmn,mtd.data_sub_dmn, mtd.db_name, mtd.src_tbl,mtd.meas_name,
                    mtd.data_src, mtd.dq_pillar, mtd.opsgenie_api_key, mtd.is_opsgenie_flg,mtd.jira_assignee
                FROM vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_mtd mtd
                INNER JOIN
                (SELECT * FROM vz-it-np-izcv-dev-idmcdo-0.dga_dq_tbls.dqaas_profile_rpt
                WHERE rpt_ref_key = '20250307032946198855') rpt
                ON mtd.prfl_id = rpt.prfl_id
                WHERE upper(mtd.prfl_type) = 'CUSTOM_RULES'

2025-03-07 03:33:58 : CRM-1159420 - isTokenExpired - INFO : Token file Path is /apps/opt/application/smartdq//smartdq_gcp_migration//config/dqaas1_oidc_token.json
2025-03-07 03:33:58 : CRM-1159420 - isTokenExpired - INFO : Token File Available
2025-03-07 03:33:58 : CRM-1159420 - isTokenExpired - INFO : Access Token is Valid
2025-03-07 03:33:58 : CRM-1159420 - bigquery_client - INFO : Setting environment variable...
2025-03-07 03:33:58 : CRM-1159420 - bigquery_client - INFO : Connected to vz-it-np-izcv-dev-idmcdo-0 project space
2025-03-07 03:34:03 : CRM-1159420 - send_opsgenie_jira_outlier_alert - WARNING : No records found for Opsgenie alert
(smartdq-venv) tdcldizcva002:/apps/opt/application/smartdq/smartdq_gcp_migration/customer_metrics_and_micro_segment$
