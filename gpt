-- rule_CL_emp_activity_type_code_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND LTRIM(RTRIM(activity_type_code)) NOT LIKE 'AT____' 
  AND activity_type_code IS NOT NULL 
  AND TRIM(activity_type_code) <> '';

-- rule_CL_emp_continous_service_date_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND LENGTH(continous_service_date) <> 7;

-- rule_CL_emp_cost_center_reference_id_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND s4_company_code IS NOT NULL 
  AND TRIM(s4_company_code) <> '' 
  AND s4_company_code NOT IN ('NONE','9111','9121')
  AND LENGTH(cost_center_reference_id) <> 10 
  AND worker_status IN ('A','L','P');

-- rule_CL_emp_country_iso_code_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND LENGTH(country_iso_code) <> 3;

-- rule_CL_emp_enterprise_id_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND LENGTH(CAST(enterprise_id AS STRING)) > 10;

-- rule_CL_emp_finance_location_Accuracy_1
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND s4_company_code IS NOT NULL 
  AND TRIM(s4_company_code) <> '' 
  AND LENGTH(finance_location) <> 10 
  AND worker_status IN ('A','L','P');

-- rule_CL_emp_hire_date_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND LENGTH(hire_date) <> 7;

-- rule_CL_emp_job_code_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND (LENGTH(job_code) <> 6 OR job_code NOT LIKE 'J%');

-- rule_CL_emp_job_level_Validity
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND job_level = 'Associate' 
  AND management_level <> 'UNN';

-- rule_CL_emp_location_reference_id_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND TRIM(COUNTRY_ISO_CODE) = 'USA'
  AND worker_status IN ('A','L','P')
  AND TRIM(location_reference_id) IS NOT NULL
  AND TRIM(location_reference_id) <> ''
  AND LENGTH(TRIM(location_reference_id)) <> 6
  AND TRIM(location_reference_id) <> 'GUM01';

-- rule_CL_emp_management_level_Validity
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND job_level = 'Associate' 
  AND management_level <> 'UNN';

-- rule_CL_emp_manager_eid_Accuracy
SELECT * FROM `vz-it-pr-j0nv-oddo-0.od_curated_workday.employee_headcount`
WHERE $incr_col2 BETWEEN $start_yr_mnth AND $end_yr_mnth
  AND manager_eid IS NOT NULL 
  AND TRIM(manager_eid) <> '' 
  AND LENGTH(manager_eid) <> 10;
